<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_sphincsplus_8h" xml:lang="en-US">
<title>C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/sphincsplus.h File Reference</title>
<indexterm><primary>C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/sphincsplus.h</primary></indexterm>
<para>

<para>The SphincsPlus API definitions <?linebreak?>Contains the primary public api for the Sphincs+ asymmetric signature scheme implementation. </para>
 
</para>
<programlisting linenumbering="unnumbered">#include &quot;common.h&quot;<?linebreak?></programlisting><simplesect>
    <title>Macros    </title>
        <itemizedlist>
            <listitem><para><anchor xml:id="_sphincsplus_8h_1a4d603a6e6148747af2bd714a77dbc059"/>#define <emphasis role="strong">QSC_SPHINCSPLUS_ALGNAME</emphasis>&#160;&#160;&#160;&quot;SPHINCSPLUS&quot;</para>

<para>The formal algorithm name. </para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para>QSC_EXPORT_API void <link linkend="_sphincsplus_8h_1a3dc132b2ade05157742c7ca4497742b1">qsc_sphincsplus_generate_keypair</link> (uint8_t *publickey, uint8_t *privatekey, bool(*rng_generate)(uint8_t *, size_t))</para>

<para>Generates a Sphincs+ public/private key-pair. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API void <link linkend="_sphincsplus_8h_1a12c5ae73878dbe9f762db4c21d974772">qsc_sphincsplus_sign</link> (uint8_t *signedmsg, size_t *smsglen, const uint8_t *message, size_t msglen, const uint8_t *privatekey, bool(*rng_generate)(uint8_t *, size_t))</para>

<para>Takes the message as input and returns an array containing the signature followed by the message. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API bool <link linkend="_sphincsplus_8h_1ada7b4f79e0ddb2b40aab039f3385554e">qsc_sphincsplus_verify</link> (uint8_t *message, size_t *msglen, const uint8_t *signedmsg, size_t smsglen, const uint8_t *publickey)</para>

<para>Verifies a signature-message pair with the public key. </para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Detailed Description</title>

<para>The SphincsPlus API definitions <?linebreak?>Contains the primary public api for the Sphincs+ asymmetric signature scheme implementation. </para>

<para><formalpara><title>Date</title>

<para>June 14, 2018 updated July 2, 2021</para>
</formalpara>
</para>

<para><formalpara>
<title>Example</title>
<para><literallayout><computeroutput><emphasis role="preprocessor">#define&#32;MSGLEN&#32;32</emphasis>
uint8_t&#32;pk[QSC_SPHINCSPLUS_PUBLICKEY_SIZE];
uint8_t&#32;sk[QSC_SPHINCSPLUS_SECRETKEY_SIZE];
uint8_t&#32;msg[32];
uint8_t&#32;smsg[QSC_SPHINCSPLUS_SIGNATURE_SIZE&#32;+&#32;MSGLEN];
uint8_t&#32;rmsg[32];
uint32_t&#32;rmsglen&#32;=&#32;0;
uint32_t&#32;smsglen&#32;=&#32;0;

qsc_sphincsplus_generate(pk,&#32;sk);
qsc_sphincsplus_sign(smsg,&#32;&amp;smsglen,&#32;msg,&#32;MSGLEN,&#32;sk);

<emphasis role="keywordflow">if</emphasis>&#32;(qsc_sphincsplus_verify(rmsg,&#32;&amp;rmsglen,&#32;smsg,&#32;smsglen,&#32;pk)&#32;!=&#32;<emphasis role="keyword">true</emphasis>)
{
&#32;&#32;&#32;&#32;authentication&#32;failed,&#32;<emphasis role="keywordflow">do</emphasis>&#32;something..
}
</computeroutput></literallayout></para>
</formalpara>
Based entirely on the C reference branch of SPHINCS+ taken from the NIST Post Quantum Competition Round 3 submission. <?linebreak?>The NIST Post Quantum Competition <link xlink:href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions">Round 3</link> Finalists. <?linebreak?>The <link xlink:href="https://sphincs.org/">SPHINCS+</link> website. <?linebreak?>The SPHINCS+ <link xlink:href="https://sphincs.org/data/sphincs+-specification.pdf">Algorithm</link> Specification. <?linebreak?></para>
</section>
<section>
<title>Function Documentation</title>
<anchor xml:id="_sphincsplus_8h_1a3dc132b2ade05157742c7ca4497742b1"/><section>
    <title>qsc_sphincsplus_generate_keypair()</title>
<indexterm><primary>qsc_sphincsplus_generate_keypair</primary><secondary>sphincsplus.h</secondary></indexterm>
<indexterm><primary>sphincsplus.h</primary><secondary>qsc_sphincsplus_generate_keypair</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API void qsc_sphincsplus_generate_keypair (uint8_t * publickey, uint8_t * privatekey, bool(* rng_generate&#160;)(uint8_t *, size_t))</computeroutput></para><para>

<para>Generates a Sphincs+ public/private key-pair. </para>
</para>

<para><warning><title>Warning</title>

<para>Arrays must be sized to QSC_SPHINCSPLUS_PUBLICKEY_SIZE and QSC_SPHINCSPLUS_SECRETKEY_SIZE.</para>
</warning>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>publickey</entry><entry>
<para>Pointer to the public verification-key array </para>
</entry>
                            </row>
                            <row>
<entry>privatekey</entry><entry>
<para>Pointer to the private signature-key array </para>
</entry>
                            </row>
                            <row>
<entry>rng_generate</entry><entry>
<para>Pointer to the random generator </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_sphincsplus_8h_1a12c5ae73878dbe9f762db4c21d974772"/><section>
    <title>qsc_sphincsplus_sign()</title>
<indexterm><primary>qsc_sphincsplus_sign</primary><secondary>sphincsplus.h</secondary></indexterm>
<indexterm><primary>sphincsplus.h</primary><secondary>qsc_sphincsplus_sign</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API void qsc_sphincsplus_sign (uint8_t * signedmsg, size_t * smsglen, const uint8_t * message, size_t msglen, const uint8_t * privatekey, bool(* rng_generate&#160;)(uint8_t *, size_t))</computeroutput></para><para>

<para>Takes the message as input and returns an array containing the signature followed by the message. </para>
</para>

<para><warning><title>Warning</title>

<para>Signature array must be sized to the size of the message plus QSC_SPHINCSPLUS_SIGNATURE_SIZE.</para>
</warning>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>signedmsg</entry><entry>
<para>Pointer to the signed-message array </para>
</entry>
                            </row>
                            <row>
<entry>smsglen</entry><entry>
<para>[const] Pointer to the signed message length </para>
</entry>
                            </row>
                            <row>
<entry>message</entry><entry>
<para>Pointer to the message array </para>
</entry>
                            </row>
                            <row>
<entry>msglen</entry><entry>
<para>The message length </para>
</entry>
                            </row>
                            <row>
<entry>privatekey</entry><entry>
<para>[const] Pointer to the private signature-key array </para>
</entry>
                            </row>
                            <row>
<entry>rng_generate</entry><entry>
<para>Pointer to the random generator </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_sphincsplus_8h_1ada7b4f79e0ddb2b40aab039f3385554e"/><section>
    <title>qsc_sphincsplus_verify()</title>
<indexterm><primary>qsc_sphincsplus_verify</primary><secondary>sphincsplus.h</secondary></indexterm>
<indexterm><primary>sphincsplus.h</primary><secondary>qsc_sphincsplus_verify</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API bool qsc_sphincsplus_verify (uint8_t * message, size_t * msglen, const uint8_t * signedmsg, size_t smsglen, const uint8_t * publickey)</computeroutput></para><para>

<para>Verifies a signature-message pair with the public key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>message</entry><entry>
<para>Pointer to the message array to be signed </para>
</entry>
                            </row>
                            <row>
<entry>msglen</entry><entry>
<para>Pointer to the message length </para>
</entry>
                            </row>
                            <row>
<entry>signedmsg</entry><entry>
<para>[const] Pointer to the signed message array </para>
</entry>
                            </row>
                            <row>
<entry>smsglen</entry><entry>
<para>The signed message length </para>
</entry>
                            </row>
                            <row>
<entry>publickey</entry><entry>
<para>[const] Pointer to the public verification-key array </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Returns true for success </para>
</formalpara>
</para>
</section>
</section>
</section>
