<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSCTest/ntru_test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('ntru__test_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ntru_test.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>NTRU Test Functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;ntru_test.h&quot;</code><br />
<code>#include &quot;<a class="el" href="katparser_8h_source.html">katparser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nistrng_8h_source.html">nistrng.h</a>&quot;</code><br />
<code>#include &quot;testutils.h&quot;</code><br />
<code>#include &quot;<a class="el" href="consoleutils_8h_source.html">../QSC/consoleutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="csp_8h_source.html">../QSC/csp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="intutils_8h_source.html">../QSC/intutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memutils_8h_source.html">../QSC/memutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ntru_8h_source.html">../QSC/ntru.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef188c934baa33e57207fcfe515ecfdc" id="r_aef188c934baa33e57207fcfe515ecfdc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef188c934baa33e57207fcfe515ecfdc">qsctest_ntru_ciphertext_integrity</a> ()</td></tr>
<tr class="memdesc:aef188c934baa33e57207fcfe515ecfdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of a mutated NTRU ciphertext.  <br /></td></tr>
<tr class="separator:aef188c934baa33e57207fcfe515ecfdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60031fd2ffe534ecd3dab2ee2971293" id="r_af60031fd2ffe534ecd3dab2ee2971293"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af60031fd2ffe534ecd3dab2ee2971293">qsctest_ntru_kat_test</a> ()</td></tr>
<tr class="memdesc:af60031fd2ffe534ecd3dab2ee2971293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the NTRU Known Answer Test (KAT).  <br /></td></tr>
<tr class="separator:af60031fd2ffe534ecd3dab2ee2971293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc82dc27ab96a4dd5cd272253b0131f" id="r_a5cc82dc27ab96a4dd5cd272253b0131f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5cc82dc27ab96a4dd5cd272253b0131f">qsctest_ntru_privatekey_integrity</a> ()</td></tr>
<tr class="memdesc:a5cc82dc27ab96a4dd5cd272253b0131f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of an altered NTRU secret key.  <br /></td></tr>
<tr class="separator:a5cc82dc27ab96a4dd5cd272253b0131f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba1e58da2b1b7069aaad0e0dc89ccf1" id="r_a2ba1e58da2b1b7069aaad0e0dc89ccf1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ba1e58da2b1b7069aaad0e0dc89ccf1">qsctest_ntru_publickey_integrity</a> ()</td></tr>
<tr class="memdesc:a2ba1e58da2b1b7069aaad0e0dc89ccf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of an altered NTRU public key.  <br /></td></tr>
<tr class="separator:a2ba1e58da2b1b7069aaad0e0dc89ccf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81720da95c2cf041235d6597942b59ce" id="r_a81720da95c2cf041235d6597942b59ce"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81720da95c2cf041235d6597942b59ce">qsctest_ntru_operations_test</a> ()</td></tr>
<tr class="memdesc:a81720da95c2cf041235d6597942b59ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stress tests NTRU operations.  <br /></td></tr>
<tr class="separator:a81720da95c2cf041235d6597942b59ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542406a16268f301c15c8d9d74eafa20" id="r_a542406a16268f301c15c8d9d74eafa20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a542406a16268f301c15c8d9d74eafa20">qsctest_ntru_run</a> ()</td></tr>
<tr class="memdesc:a542406a16268f301c15c8d9d74eafa20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the complete NTRU test suite.  <br /></td></tr>
<tr class="separator:a542406a16268f301c15c8d9d74eafa20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>NTRU Test Functions. </p>
<p>This source file implements a test suite for the NTRU key encapsulation mechanism (KEM) implementation. The tests verify the correctness, integrity, and resilience of the NTRU algorithm by performing the following:</p>
<ul>
<li><b>Ciphertext Integrity Test</b>: <br  />
 The function <code>qsctest_ntru_ciphertext_integrity()</code> generates a NTRU key pair and encapsulates a shared secret. It then deliberately mutates the ciphertext using random data and attempts to decapsulate it. The test passes if decapsulation fails and the derived shared secret differs from the expected one.</li>
<li><b>Known Answer Test (KAT)</b>: <br  />
 The function <code>qsctest_ntru_kat_test()</code> parses known answer test vectors from a NIST PQC Round 3 response file, generates a key pair, encapsulates a shared secret, and verifies that the generated public key, private key, ciphertext, and shared secret match the expected values.</li>
<li><b>Operations Stress Test</b>: <br  />
 The function <code>qsctest_ntru_operations_test()</code> repeatedly generates key pairs, encapsulates a shared secret, and decapsulates the ciphertext to verify that the shared secret derived from encapsulation matches the one obtained via decapsulation. It also tests an alternate encrypt/decrypt API.</li>
<li><b>Private Key Integrity Test</b>: <br  />
 The function <code>qsctest_ntru_privatekey_integrity()</code> alters part of the secret key with random data and then checks that decapsulation fails, ensuring that an invalid secret key does not produce the expected shared secret.</li>
<li><b>Public Key Integrity Test</b>: <br  />
 The function <code>qsctest_ntru_publickey_integrity()</code> modifies the public key with random data and then verifies that decapsulation using the valid secret key fails, ensuring that tampering with the public key is detected.</li>
</ul>
<p>The function <code>qsctest_ntru_run()</code> executes all the tests sequentially and prints the results. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aef188c934baa33e57207fcfe515ecfdc" name="aef188c934baa33e57207fcfe515ecfdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef188c934baa33e57207fcfe515ecfdc">&#9670;&#160;</a></span>qsctest_ntru_ciphertext_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_ntru_ciphertext_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of a mutated NTRU ciphertext. </p>
<p>This test function performs the following steps:</p><ul>
<li>Generates a NTRU key pair.</li>
<li>Encapsulates a shared secret using the generated public key.</li>
<li>Mutates the resulting ciphertext by overwriting part of it with random data.</li>
<li>Attempts to decapsulate the mutated ciphertext using the corresponding secret key. The test is considered successful if decapsulation fails and the derived shared secret does not match the originally encapsulated shared secret.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the ciphertext integrity check passes; otherwise, false. </dd></dl>

</div>
</div>
<a id="af60031fd2ffe534ecd3dab2ee2971293" name="af60031fd2ffe534ecd3dab2ee2971293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60031fd2ffe534ecd3dab2ee2971293">&#9670;&#160;</a></span>qsctest_ntru_kat_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_ntru_kat_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the NTRU Known Answer Test (KAT). </p>
<p>This function verifies the correctness of the NTRU implementation by:</p><ul>
<li>Parsing a NIST PQC Round 3 KAT response file to obtain the expected seed, public key, private key, ciphertext, and shared secret.</li>
<li>Initializing a PRNG with the parsed seed.</li>
<li>Generating a NTRU key pair and comparing the generated keys with the expected ones.</li>
<li>Encapsulating a shared secret and comparing the resulting ciphertext and shared secret against the expected values.</li>
<li>Decapsulating the ciphertext and verifying that the shared secret derived matches both the encapsulated value and the known answer.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all generated values match the known answer test vectors; otherwise, false. </dd></dl>

</div>
</div>
<a id="a81720da95c2cf041235d6597942b59ce" name="a81720da95c2cf041235d6597942b59ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81720da95c2cf041235d6597942b59ce">&#9670;&#160;</a></span>qsctest_ntru_operations_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_ntru_operations_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stress tests NTRU operations. </p>
<p>This function conducts a stress test on the NTRU key encapsulation mechanism by:</p><ul>
<li>Generating a NTRU key pair.</li>
<li>Encapsulating a shared secret to produce a ciphertext and shared secret.</li>
<li>Decapsulating the ciphertext to derive the shared secret.</li>
<li>Comparing the shared secrets obtained from encapsulation and decapsulation.</li>
<li>Exercising an alternate encrypt/decrypt API by clearing buffers, generating a fresh seed, and verifying that the shared secrets produced by both interfaces are identical.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the shared secrets match and all operations are successful; otherwise, false. </dd></dl>

</div>
</div>
<a id="a5cc82dc27ab96a4dd5cd272253b0131f" name="a5cc82dc27ab96a4dd5cd272253b0131f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cc82dc27ab96a4dd5cd272253b0131f">&#9670;&#160;</a></span>qsctest_ntru_privatekey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_ntru_privatekey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of an altered NTRU secret key. </p>
<p>This test generates a valid NTRU key pair and encapsulates a shared secret. It then alters the secret key (by replacing a portion of it with random data) and attempts to decapsulate the previously produced ciphertext. The test passes if decapsulation fails or the derived shared secret does not match the expected shared secret.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the secret key integrity test passes; otherwise, false. </dd></dl>

</div>
</div>
<a id="a2ba1e58da2b1b7069aaad0e0dc89ccf1" name="a2ba1e58da2b1b7069aaad0e0dc89ccf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba1e58da2b1b7069aaad0e0dc89ccf1">&#9670;&#160;</a></span>qsctest_ntru_publickey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_ntru_publickey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of an altered NTRU public key. </p>
<p>This function generates a NTRU key pair, then mutates the public key by overwriting some of its bytes with random data. It encapsulates a shared secret using the tampered public key and attempts decapsulation using the valid secret key. The test is successful if the shared secret derived from decapsulation is invalid.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the public key integrity test passes; otherwise, false. </dd></dl>

</div>
</div>
<a id="a542406a16268f301c15c8d9d74eafa20" name="a542406a16268f301c15c8d9d74eafa20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542406a16268f301c15c8d9d74eafa20">&#9670;&#160;</a></span>qsctest_ntru_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_ntru_run </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the complete NTRU test suite. </p>
<p>This function executes all the NTRU tests, including:</p><ul>
<li>The Known Answer Test (KAT) to verify that key generation, encapsulation, and decapsulation produce expected values.</li>
<li>The operations stress test to verify repeated key encapsulation and decapsulation.</li>
<li>The private key integrity test to ensure that an altered secret key invalidates the shared secret.</li>
<li>The public key integrity test to ensure that a tampered public key leads to decapsulation failure.</li>
<li>The ciphertext integrity test to confirm that modified ciphertext does not yield the correct shared secret.</li>
</ul>
<p>Test results are printed to the console. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_12ba33f14d153ce862ef28362b3660f0.html">QSCTest</a></li><li class="navelem"><a class="el" href="ntru__test_8c.html">ntru_test.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
