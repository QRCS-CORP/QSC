<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSCTest/kyber_test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('kyber__test_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">kyber_test.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Kyber Test Functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;kyber_test.h&quot;</code><br />
<code>#include &quot;<a class="el" href="katparser_8h_source.html">katparser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nistrng_8h_source.html">nistrng.h</a>&quot;</code><br />
<code>#include &quot;testutils.h&quot;</code><br />
<code>#include &quot;<a class="el" href="consoleutils_8h_source.html">../QSC/consoleutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="csp_8h_source.html">../QSC/csp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="intutils_8h_source.html">../QSC/intutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kyber_8h_source.html">../QSC/kyber.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memutils_8h_source.html">../QSC/memutils.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aabe825de9755ebd53de6412dc4b52f7a" id="r_aabe825de9755ebd53de6412dc4b52f7a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aabe825de9755ebd53de6412dc4b52f7a">qsctest_kyber_ciphertext_integrity</a> ()</td></tr>
<tr class="memdesc:aabe825de9755ebd53de6412dc4b52f7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the validity of a mutated ciphertext.  <br /></td></tr>
<tr class="separator:aabe825de9755ebd53de6412dc4b52f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335c9065a395633be60afe837083e4bd" id="r_a335c9065a395633be60afe837083e4bd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a335c9065a395633be60afe837083e4bd">qsctest_kyber_kat_test</a> ()</td></tr>
<tr class="memdesc:a335c9065a395633be60afe837083e4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the Kyber Known Answer Test (KAT).  <br /></td></tr>
<tr class="separator:a335c9065a395633be60afe837083e4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f574015474d53571d579f5d06d7c3d" id="r_a06f574015474d53571d579f5d06d7c3d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06f574015474d53571d579f5d06d7c3d">qsctest_kyber_privatekey_integrity</a> ()</td></tr>
<tr class="memdesc:a06f574015474d53571d579f5d06d7c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of an altered Kyber secret key.  <br /></td></tr>
<tr class="separator:a06f574015474d53571d579f5d06d7c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e1411627d528938c9fc6d62e391763" id="r_a68e1411627d528938c9fc6d62e391763"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68e1411627d528938c9fc6d62e391763">qsctest_kyber_publickey_integrity</a> ()</td></tr>
<tr class="memdesc:a68e1411627d528938c9fc6d62e391763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of an altered Kyber public key.  <br /></td></tr>
<tr class="separator:a68e1411627d528938c9fc6d62e391763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b81c64d28709e732041c005fd9c077" id="r_a08b81c64d28709e732041c005fd9c077"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08b81c64d28709e732041c005fd9c077">qsctest_kyber_operations_test</a> ()</td></tr>
<tr class="memdesc:a08b81c64d28709e732041c005fd9c077"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a stress test on Kyber operations.  <br /></td></tr>
<tr class="separator:a08b81c64d28709e732041c005fd9c077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31fcfa23ab3bab0db4cadbe53d8da2d7" id="r_a31fcfa23ab3bab0db4cadbe53d8da2d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31fcfa23ab3bab0db4cadbe53d8da2d7">qsctest_kyber_run</a> ()</td></tr>
<tr class="memdesc:a31fcfa23ab3bab0db4cadbe53d8da2d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs all Kyber implementation tests.  <br /></td></tr>
<tr class="separator:a31fcfa23ab3bab0db4cadbe53d8da2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Kyber Test Functions. </p>
<p>This file contains tests for the Kyber key encapsulation mechanism (KEM) implementation as specified in the NIST PQC Round 3 submissions. The test suite includes:</p>
<ul>
<li>A Known Answer Test (KAT) that verifies the generated public and private keys, the ciphertext, and the derived shared secret against expected test vectors.</li>
<li>A ciphertext integrity test that ensures that modifying the ciphertext results in an invalid shared secret.</li>
<li>A stress test that repeatedly generates key pairs, encapsulates, and decapsulates to verify that both parties derive the same shared secret.</li>
<li>Integrity tests that check whether altering the secret key or public key causes the derived shared secret to differ from the expected result.</li>
</ul>
<h1><a class="anchor" id="kyber_test_links"></a>
Reference Links</h1>
<ul>
<li>NIST PQC Round 3 test vectors. </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aabe825de9755ebd53de6412dc4b52f7a" name="aabe825de9755ebd53de6412dc4b52f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe825de9755ebd53de6412dc4b52f7a">&#9670;&#160;</a></span>qsctest_kyber_ciphertext_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_kyber_ciphertext_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the validity of a mutated ciphertext. </p>
<p>This function generates a Kyber key pair and encapsulates a shared secret, then intentionally mutates the ciphertext using random data. It attempts to decapsulate the altered ciphertext. The test passes if decapsulation fails and the derived shared secret does not match the expected shared secret.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the mutated ciphertext is correctly detected as invalid; otherwise, false. </dd></dl>

</div>
</div>
<a id="a335c9065a395633be60afe837083e4bd" name="a335c9065a395633be60afe837083e4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a335c9065a395633be60afe837083e4bd">&#9670;&#160;</a></span>qsctest_kyber_kat_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_kyber_kat_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the Kyber Known Answer Test (KAT). </p>
<p>This function verifies the correctness of the Kyber implementation by comparing the generated public key, secret key, ciphertext, and shared secret with known answer test vectors from the NIST PQC Round 3 test files. It parses the test vectors from the appropriate response file based on the active parameter set and compares them against the output produced by the Kyber key encapsulation mechanism.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all generated values match the known answer test vectors; otherwise, false. </dd></dl>

</div>
</div>
<a id="a08b81c64d28709e732041c005fd9c077" name="a08b81c64d28709e732041c005fd9c077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b81c64d28709e732041c005fd9c077">&#9670;&#160;</a></span>qsctest_kyber_operations_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_kyber_operations_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a stress test on Kyber operations. </p>
<p>This function tests the key generation, encapsulation, and decapsulation operations of the Kyber KEM. It first generates a key pair, then encapsulates a shared secret, and decapsulates it. The test also exercises an alternate encrypt/decrypt API by clearing buffers and using a different interface. The test passes if the shared secrets derived from encapsulation and decapsulation match.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all operations yield the expected shared secret; otherwise, false. </dd></dl>

</div>
</div>
<a id="a06f574015474d53571d579f5d06d7c3d" name="a06f574015474d53571d579f5d06d7c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06f574015474d53571d579f5d06d7c3d">&#9670;&#160;</a></span>qsctest_kyber_privatekey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_kyber_privatekey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of an altered Kyber secret key. </p>
<p>This test generates a Kyber key pair and encapsulates a shared secret. It then intentionally alters a portion of the secret key with random data and attempts to decapsulate the ciphertext using the modified key. The test is successful if decapsulation fails and the derived shared secret does not match the expected value.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the invalid secret key is correctly detected; otherwise, false. </dd></dl>

</div>
</div>
<a id="a68e1411627d528938c9fc6d62e391763" name="a68e1411627d528938c9fc6d62e391763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e1411627d528938c9fc6d62e391763">&#9670;&#160;</a></span>qsctest_kyber_publickey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_kyber_publickey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of an altered Kyber public key. </p>
<p>This function generates a Kyber key pair and then replaces part of the public key with random values. It then encapsulates a shared secret using the altered public key and attempts decapsulation using the valid secret key. The test passes if decapsulation fails and the derived shared secret does not match the expected result.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the invalid public key is correctly detected; otherwise, false. </dd></dl>

</div>
</div>
<a id="a31fcfa23ab3bab0db4cadbe53d8da2d7" name="a31fcfa23ab3bab0db4cadbe53d8da2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31fcfa23ab3bab0db4cadbe53d8da2d7">&#9670;&#160;</a></span>qsctest_kyber_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_kyber_run </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs all Kyber implementation tests. </p>
<p>This function sequentially executes the following tests:</p><ul>
<li>The Known Answer Test (KAT) to verify key generation and shared secret derivation.</li>
<li>A stress test for key generation, encapsulation, and decapsulation.</li>
<li>The secret key integrity test, ensuring that modifications to the secret key invalidate the shared secret.</li>
<li>The public key integrity test, ensuring that alterations to the public key result in decapsulation failure.</li>
<li>The ciphertext integrity test, confirming that tampered ciphertext leads to an invalid shared secret.</li>
</ul>
<p>The results of each test are printed to the console. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_12ba33f14d153ce862ef28362b3660f0.html">QSCTest</a></li><li class="navelem"><a class="el" href="kyber__test_8c.html">kyber_test.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
