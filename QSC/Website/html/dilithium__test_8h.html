<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSCTest/dilithium_test.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dilithium__test_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">dilithium_test.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Dilithium Test Suite for the Digital Signature Scheme.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;common.h&quot;</code><br />
</div>
<p><a href="dilithium__test_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2decb7ca03db89b376905e86b0ac4cdc" id="r_a2decb7ca03db89b376905e86b0ac4cdc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2decb7ca03db89b376905e86b0ac4cdc">QSCTEST_DILITHIUM_MLEN</a>&#160;&#160;&#160;33</td></tr>
<tr class="memdesc:a2decb7ca03db89b376905e86b0ac4cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Length (in bytes) of the test message used in Dilithium tests.  <br /></td></tr>
<tr class="separator:a2decb7ca03db89b376905e86b0ac4cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca5187e39c9d54d7b4cf3500488c86c1" id="r_aca5187e39c9d54d7b4cf3500488c86c1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca5187e39c9d54d7b4cf3500488c86c1">qsctest_dilithium_kat_test</a> (void)</td></tr>
<tr class="memdesc:aca5187e39c9d54d7b4cf3500488c86c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the known answer test (KAT) for the Dilithium signature scheme.  <br /></td></tr>
<tr class="separator:aca5187e39c9d54d7b4cf3500488c86c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ab14cdd89d1c9ba128e24192ad10eb9" id="r_a1ab14cdd89d1c9ba128e24192ad10eb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ab14cdd89d1c9ba128e24192ad10eb9">qsctest_dilithium_privatekey_integrity</a> (void)</td></tr>
<tr class="memdesc:a1ab14cdd89d1c9ba128e24192ad10eb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of a mutated secret key.  <br /></td></tr>
<tr class="separator:a1ab14cdd89d1c9ba128e24192ad10eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e0eb20379412220bc2015f80b6d818" id="r_a18e0eb20379412220bc2015f80b6d818"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18e0eb20379412220bc2015f80b6d818">qsctest_dilithium_publickey_integrity</a> (void)</td></tr>
<tr class="memdesc:a18e0eb20379412220bc2015f80b6d818"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of a mutated public key.  <br /></td></tr>
<tr class="separator:a18e0eb20379412220bc2015f80b6d818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409489462a243206d6de25bfff8d2be2" id="r_a409489462a243206d6de25bfff8d2be2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a409489462a243206d6de25bfff8d2be2">qsctest_dilithium_signature_integrity</a> (void)</td></tr>
<tr class="memdesc:a409489462a243206d6de25bfff8d2be2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of a mutated signature.  <br /></td></tr>
<tr class="separator:a409489462a243206d6de25bfff8d2be2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba214aab36e9e4c6690be218f35f143e" id="r_aba214aab36e9e4c6690be218f35f143e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba214aab36e9e4c6690be218f35f143e">qsctest_dilithium_stress_test</a> (void)</td></tr>
<tr class="memdesc:aba214aab36e9e4c6690be218f35f143e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a stress test on Dilithium key generation, signing, and verification operations.  <br /></td></tr>
<tr class="separator:aba214aab36e9e4c6690be218f35f143e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb7c7bfc038548e858865decd680e4b7" id="r_acb7c7bfc038548e858865decd680e4b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb7c7bfc038548e858865decd680e4b7">qsctest_dilithium_run</a> (void)</td></tr>
<tr class="memdesc:acb7c7bfc038548e858865decd680e4b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs all Dilithium test functions.  <br /></td></tr>
<tr class="separator:acb7c7bfc038548e858865decd680e4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Dilithium Test Suite for the Digital Signature Scheme. </p>
<p>This header defines a set of tests for the Dilithium digital signature scheme implementation. The test suite is designed to verify the correct operation of the Dilithium scheme by performing the following:</p>
<ul>
<li><b>Known Answer Test (KAT)</b>: <br  />
 Validates key pair generation, signing, and signature verification using expected test vectors from the NIST Dilithium FIPS 204 specification. It confirms that the generated public key, secret key, signature, and recovered message exactly match the expected values.</li>
<li><b>Secret Key Integrity Test</b>: <br  />
 Intentionally mutates a portion of the secret key (by flipping bits) to verify that any tampering with the secret key results in a failure of signature verification.</li>
<li><b>Public Key Integrity Test</b>: <br  />
 Alters bits in the public key and ensures that signature verification fails, confirming that any corruption in the public key is reliably detected.</li>
<li><b>Signature Integrity Test</b>: <br  />
 Modifies the signature by flipping one or more bits and then checks that signature verification fails.</li>
<li><b>Stress Test</b>: <br  />
 Repeatedly generates key pairs, signs a fixed-length test message, and verifies the signature to ensure robust operation under extended use. This test also verifies that the signature length and the recovered message are as expected.</li>
</ul>
<p>The known answer test uses one of the NIST FIPS 204 test vector files, selected based on the active parameter set:</p><ul>
<li>If <code>QSC_DILITHIUM_S1P2544</code> is defined, the file <code>"NPQCR3/dilithium-2544.rsp"</code> is used.</li>
<li>If <code>QSC_DILITHIUM_S3P4016</code> is defined, the file <code>"NPQCR3/dilithium-4016.rsp"</code> is used.</li>
<li>If <code>QSC_DILITHIUM_S5P4880</code> is defined, the file <code>"NPQCR3/dilithium-4880.rsp"</code> is used.</li>
</ul>
<h1><a class="anchor" id="dilithium_test_links"></a>
Reference Links</h1>
<ul>
<li><a href="https://csrc.nist.gov/pubs/fips/204/final">NIST Dilithium FIPS 204 Main page</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">NIST Dilithium FIPS 204 Specification</a> </li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2decb7ca03db89b376905e86b0ac4cdc" name="a2decb7ca03db89b376905e86b0ac4cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2decb7ca03db89b376905e86b0ac4cdc">&#9670;&#160;</a></span>QSCTEST_DILITHIUM_MLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QSCTEST_DILITHIUM_MLEN&#160;&#160;&#160;33</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Length (in bytes) of the test message used in Dilithium tests. </p>
<p>This macro defines the size of the test message. It is set to 33 bytes. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aca5187e39c9d54d7b4cf3500488c86c1" name="aca5187e39c9d54d7b4cf3500488c86c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5187e39c9d54d7b4cf3500488c86c1">&#9670;&#160;</a></span>qsctest_dilithium_kat_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_dilithium_kat_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the known answer test (KAT) for the Dilithium signature scheme. </p>
<p>This test performs the following steps:</p><ul>
<li>Parses the NIST FIPS 204 test vector file to retrieve the expected seed, message, public key, secret key, and signature.</li>
<li>Initializes a NIST-compliant PRNG using the extracted seed.</li>
<li>Generates a key pair using the PRNG.</li>
<li>Compares the generated public and secret keys with the expected values.</li>
<li>Signs the fixed test message using the generated secret key.</li>
<li>Compares the resulting signature with the expected signature.</li>
<li>Verifies the signature using the generated public key and ensures that the recovered message matches the original.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the generated keys, signature, and recovered message match the expected test vectors. </dd></dl>

</div>
</div>
<a id="a1ab14cdd89d1c9ba128e24192ad10eb9" name="a1ab14cdd89d1c9ba128e24192ad10eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ab14cdd89d1c9ba128e24192ad10eb9">&#9670;&#160;</a></span>qsctest_dilithium_privatekey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_dilithium_privatekey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of a mutated secret key. </p>
<p>This test deliberately flips bits in the secret key (specifically, in the portion following the public key) and then attempts to sign a test message. The test is considered successful if signature verification fails, indicating that any alteration of the secret key is correctly detected.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the signature verification fails when the secret key is altered. </dd></dl>

</div>
</div>
<a id="a18e0eb20379412220bc2015f80b6d818" name="a18e0eb20379412220bc2015f80b6d818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e0eb20379412220bc2015f80b6d818">&#9670;&#160;</a></span>qsctest_dilithium_publickey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_dilithium_publickey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of a mutated public key. </p>
<p>This test flips bits in the public key and then attempts to verify a signature produced with the unaltered secret key. The test passes if the signature verification fails, confirming that any tampering with the public key is reliably detected.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if signature verification fails when the public key is modified. </dd></dl>

</div>
</div>
<a id="acb7c7bfc038548e858865decd680e4b7" name="acb7c7bfc038548e858865decd680e4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb7c7bfc038548e858865decd680e4b7">&#9670;&#160;</a></span>qsctest_dilithium_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_dilithium_run </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs all Dilithium test functions. </p>
<p>This function sequentially executes all tests for the Dilithium signature scheme, including:</p><ul>
<li>The known answer test (KAT) to verify key generation, signing, and verification against expected test vectors.</li>
<li>The secret key integrity test, which ensures that modifications to the secret key result in verification failure.</li>
<li>The public key integrity test, which ensures that modifications to the public key result in verification failure.</li>
<li>The signature integrity test, which confirms that even minor changes to the signature cause verification to fail.</li>
<li>A stress test that validates the robustness of the key generation, signing, and verification operations over multiple iterations.</li>
</ul>
<p>Test results are printed to the console. </p>

</div>
</div>
<a id="a409489462a243206d6de25bfff8d2be2" name="a409489462a243206d6de25bfff8d2be2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409489462a243206d6de25bfff8d2be2">&#9670;&#160;</a></span>qsctest_dilithium_signature_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_dilithium_signature_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of a mutated signature. </p>
<p>This test modifies the signature by flipping one or more bits (e.g., the last byte or a byte in the middle) and then attempts to verify the signature against the original public key. The test passes if the altered signature fails verification.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the signature verification fails with the modified signature. </dd></dl>

</div>
</div>
<a id="aba214aab36e9e4c6690be218f35f143e" name="aba214aab36e9e4c6690be218f35f143e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba214aab36e9e4c6690be218f35f143e">&#9670;&#160;</a></span>qsctest_dilithium_stress_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_dilithium_stress_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a stress test on Dilithium key generation, signing, and verification operations. </p>
<p>This function repeatedly (in a single execution) performs the following:</p><ul>
<li>Generates a key pair.</li>
<li>Signs a fixed test message of length QSCTEST_DILITHIUM_MLEN bytes.</li>
<li>Verifies the signature and checks that the signature length is as expected.</li>
<li>Confirms that the message recovered from the signature matches the original test message.</li>
</ul>
<p>The stress test is designed to assess the robustness and performance of the Dilithium implementation under extended use.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all stress test operations are successful. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_12ba33f14d153ce862ef28362b3660f0.html">QSCTest</a></li><li class="navelem"><a class="el" href="dilithium__test_8h.html">dilithium_test.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
