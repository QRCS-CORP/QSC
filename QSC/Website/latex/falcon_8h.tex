\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/falcon.h File Reference}
\hypertarget{falcon_8h}{}\label{falcon_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/falcon.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/falcon.h}}


Contains the primary public api for the Falcon asymmetric signature scheme implementation.  


{\ttfamily \#include "{}common.\+h"{}}\newline
Include dependency graph for falcon.\+h\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{falcon_8h_adf7407d45b4967a666e0339a926dc361}\label{falcon_8h_adf7407d45b4967a666e0339a926dc361} 
\#define {\bfseries QSC\+\_\+\+FALCON\+\_\+\+ALGNAME}~"{}FALCON"{}
\begin{DoxyCompactList}\small\item\em The formal algorithm name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{falcon_8h_ad50c9f6d57a616047858b4e0d31f93b2}{qsc\+\_\+falcon\+\_\+generate\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates a Falcon public/private key-\/pair. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{falcon_8h_a37ede4bfd3a066d853f9d5cfb991ac41}{qsc\+\_\+falcon\+\_\+sign}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t \texorpdfstring{$\ast$}{*}smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Takes the message as input and returns an array containing the signature followed by the message. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{falcon_8h_a7d609dba718823e9ba023ca62864ce91}{qsc\+\_\+falcon\+\_\+verify}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t \texorpdfstring{$\ast$}{*}msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey)
\begin{DoxyCompactList}\small\item\em Verifies a signature-\/message pair with the public key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains the primary public api for the Falcon asymmetric signature scheme implementation. 

\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ An\ example\ of\ key-\/pair\ creation,\ encryption,\ and\ decryption}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ MSGLEN\ 32}}
\DoxyCodeLine{uint8\_t\ pk[QSC\_FALCON\_PUBLICKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ sk[QSC\_FALCON\_SECRETKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ msg[32];}
\DoxyCodeLine{uint8\_t\ smsg[QSC\_FALCON\_SIGNATURE\_SIZE\ +\ MSGLEN];}
\DoxyCodeLine{uint8\_t\ rmsg[32];}
\DoxyCodeLine{}
\DoxyCodeLine{uint32\_t\ rmsglen\ =\ 0;}
\DoxyCodeLine{uint32\_t\ smsglen\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ create\ the\ public\ and\ secret\ keys}}
\DoxyCodeLine{qsc\_falcon\_generate(pk,\ sk);}
\DoxyCodeLine{\textcolor{comment}{//\ returns\ the\ signed\ the\ message\ in\ smsg}}
\DoxyCodeLine{qsc\_falcon\_sign(smsg,\ \&smsglen,\ msg,\ MSGLEN,\ sk);}
\DoxyCodeLine{\textcolor{comment}{//\ test\ the\ signature\ and\ return\ the\ message\ bytes\ in\ rmsg}}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_falcon\_verify(rmsg,\ \&rmsglen,\ smsg,\ smsglen,\ pk)\ !=\ \textcolor{keyword}{true})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ authentication\ failed,\ do\ something..}}
\DoxyCodeLine{\}}

\end{DoxyCode}

\end{DoxyParagraph}
Based entirely on the C reference branch of Falcon taken from the NIST Post Quantum Competition Round 3 submission. ~\newline
The NIST Post Quantum Competition \href{https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions}{\texttt{ Round 3}} Finalists. ~\newline
The \href{https://falcon-sign.info/}{\texttt{ Falcon}} website. ~\newline
The Falcon \href{https://falcon-sign.info/falcon.pdf}{\texttt{ Algorithm}} Specification. 

\doxysubsection{Function Documentation}
\Hypertarget{falcon_8h_ad50c9f6d57a616047858b4e0d31f93b2}\index{falcon.h@{falcon.h}!qsc\_falcon\_generate\_keypair@{qsc\_falcon\_generate\_keypair}}
\index{qsc\_falcon\_generate\_keypair@{qsc\_falcon\_generate\_keypair}!falcon.h@{falcon.h}}
\doxysubsubsection{\texorpdfstring{qsc\_falcon\_generate\_keypair()}{qsc\_falcon\_generate\_keypair()}}
{\footnotesize\ttfamily \label{falcon_8h_ad50c9f6d57a616047858b4e0d31f93b2} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+falcon\+\_\+generate\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates a Falcon public/private key-\/pair. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+FALCON\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+FALCON\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the public verification-\/key array \\
\hline
{\em privatekey} & Pointer to the private signature-\/key array \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{falcon_8h_a37ede4bfd3a066d853f9d5cfb991ac41}\index{falcon.h@{falcon.h}!qsc\_falcon\_sign@{qsc\_falcon\_sign}}
\index{qsc\_falcon\_sign@{qsc\_falcon\_sign}!falcon.h@{falcon.h}}
\doxysubsubsection{\texorpdfstring{qsc\_falcon\_sign()}{qsc\_falcon\_sign()}}
{\footnotesize\ttfamily \label{falcon_8h_a37ede4bfd3a066d853f9d5cfb991ac41} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+falcon\+\_\+sign (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Takes the message as input and returns an array containing the signature followed by the message. 

\begin{DoxyWarning}{Warning}
Signature array must be sized to the size of the message plus QSC\+\_\+\+FALCON\+\_\+\+SIGNATURE\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em signedmsg} & Pointer to the signed-\/message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em message} & \mbox{[}const\mbox{]} Pointer to the message array \\
\hline
{\em msglen} & The message array length \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the private signature-\/key \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{falcon_8h_a7d609dba718823e9ba023ca62864ce91}\index{falcon.h@{falcon.h}!qsc\_falcon\_verify@{qsc\_falcon\_verify}}
\index{qsc\_falcon\_verify@{qsc\_falcon\_verify}!falcon.h@{falcon.h}}
\doxysubsubsection{\texorpdfstring{qsc\_falcon\_verify()}{qsc\_falcon\_verify()}}
{\footnotesize\ttfamily \label{falcon_8h_a7d609dba718823e9ba023ca62864ce91} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+falcon\+\_\+verify (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{}\end{DoxyParamCaption})}



Verifies a signature-\/message pair with the public key. 


\begin{DoxyParams}{Parameters}
{\em message} & Pointer to the message output array \\
\hline
{\em msglen} & Length of the message array \\
\hline
{\em signedmsg} & \mbox{[}const\mbox{]} Pointer to the signed message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public verification-\/key array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
