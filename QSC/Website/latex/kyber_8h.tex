\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/kyber.h File Reference}
\hypertarget{kyber_8h}{}\label{kyber_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/kyber.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/kyber.h}}


Contains the primary public api for the Kyber CCA-\/secure Key Encapsulation Mechanism implementation.  


{\ttfamily \#include "{}common.\+h"{}}\newline
{\ttfamily \#include "{}kyberbase.\+h"{}}\newline
Include dependency graph for kyber.\+h\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{kyber_8h_a314a086ebb183778749b7f425ba7d46e}\label{kyber_8h_a314a086ebb183778749b7f425ba7d46e} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE}~(QSC\+\_\+\+KYBER\+\_\+\+INDCPA\+\_\+\+BYTES)
\begin{DoxyCompactList}\small\item\em The byte size of the cipher-\/text array. \end{DoxyCompactList}\item 
\Hypertarget{kyber_8h_a324d3b4dde6bd2bba5ad414c82f15b66}\label{kyber_8h_a324d3b4dde6bd2bba5ad414c82f15b66} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+PRIVATEKEY\+\_\+\+SIZE}~(QSC\+\_\+\+KYBER\+\_\+\+INDCPA\+\_\+\+SECRETKEY\+\_\+\+BYTES +  QSC\+\_\+\+KYBER\+\_\+\+INDCPA\+\_\+\+PUBLICKEY\+\_\+\+BYTES + (2 \texorpdfstring{$\ast$}{*} QSC\+\_\+\+KYBER\+\_\+\+SYMBYTES))
\begin{DoxyCompactList}\small\item\em The byte size of the secret private-\/key array. \end{DoxyCompactList}\item 
\Hypertarget{kyber_8h_adde5321c5b55a0c87eff031f89dfa756}\label{kyber_8h_adde5321c5b55a0c87eff031f89dfa756} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+PUBLICKEY\+\_\+\+SIZE}~(QSC\+\_\+\+KYBER\+\_\+\+INDCPA\+\_\+\+PUBLICKEY\+\_\+\+BYTES)
\begin{DoxyCompactList}\small\item\em The byte size of the public-\/key array. \end{DoxyCompactList}\item 
\Hypertarget{kyber_8h_a8e5ba39a57a1f9fc4af613d957ca3df5}\label{kyber_8h_a8e5ba39a57a1f9fc4af613d957ca3df5} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+SEED\+\_\+\+SIZE}~32
\begin{DoxyCompactList}\small\item\em The byte size of the seed array. \end{DoxyCompactList}\item 
\Hypertarget{kyber_8h_ae7c6524a5c0bf0336df3af0f7d2eb297}\label{kyber_8h_ae7c6524a5c0bf0336df3af0f7d2eb297} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+SHAREDSECRET\+\_\+\+SIZE}~32
\begin{DoxyCompactList}\small\item\em The byte size of the shared secret-\/key array. \end{DoxyCompactList}\item 
\Hypertarget{kyber_8h_a194c8e38e2ddb685cae84e38783da144}\label{kyber_8h_a194c8e38e2ddb685cae84e38783da144} 
\#define {\bfseries QSC\+\_\+\+KYBER\+\_\+\+ALGNAME}~"{}KYBER"{}
\begin{DoxyCompactList}\small\item\em The formal algorithm name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{kyber_8h_a07e969adf524c02dfc8e069bc383f163}{qsc\+\_\+kyber\+\_\+decapsulate}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}secret, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey)
\begin{DoxyCompactList}\small\item\em Decapsulates the shared secret for a given cipher-\/text using a private-\/key. Used in conjunction with the encapsulate function. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{kyber_8h_ac29729a9d20073fb5bf0caaf07e47513}{qsc\+\_\+kyber\+\_\+decrypt}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}secret, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey)
\begin{DoxyCompactList}\small\item\em Decrypts the shared secret for a given cipher-\/text using a private-\/key Used in conjunction with the encrypt function. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{kyber_8h_a2846270dbee6004f92b992fa2b533908}{qsc\+\_\+kyber\+\_\+encapsulate}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}secret, uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates cipher-\/text and encapsulates a shared secret key using a public-\/key. Used in conjunction with the decapsulate function. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{kyber_8h_a692db6b4a2e4ba5356b68380feca1494}{qsc\+\_\+kyber\+\_\+encrypt}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}secret, uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, const uint8\+\_\+t seed\mbox{[}\mbox{\hyperlink{kyber_8h_a8e5ba39a57a1f9fc4af613d957ca3df5}{QSC\+\_\+\+KYBER\+\_\+\+SEED\+\_\+\+SIZE}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Generates cipher-\/text and encapsulates a shared secret key using a public-\/key Used in conjunction with the encrypt function. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{kyber_8h_a371669e2f7670c62f46402cad358f383}{qsc\+\_\+kyber\+\_\+generate\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates public and private key for the KYBER key encapsulation mechanism. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains the primary public api for the Kyber CCA-\/secure Key Encapsulation Mechanism implementation. 

\begin{DoxyDate}{Date}
January 10, 2018 updated July 2, 2021
\end{DoxyDate}
\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ An\ example\ of\ key-\/pair\ creation,\ encryption,\ and\ decryption}}
\DoxyCodeLine{uint8\_t\ ct[\mbox{\hyperlink{kyber_8h_a314a086ebb183778749b7f425ba7d46e}{QSC\_KYBER\_CIPHERTEXT\_SIZE}}];}
\DoxyCodeLine{uint8\_t\ pk[\mbox{\hyperlink{kyber_8h_adde5321c5b55a0c87eff031f89dfa756}{QSC\_KYBER\_PUBLICKEY\_SIZE}}];}
\DoxyCodeLine{uint8\_t\ sk[\mbox{\hyperlink{kyber_8h_a324d3b4dde6bd2bba5ad414c82f15b66}{QSC\_KYBER\_PRIVATEKEY\_SIZE}}];}
\DoxyCodeLine{uint8\_t\ ssa[\mbox{\hyperlink{kyber_8h_ae7c6524a5c0bf0336df3af0f7d2eb297}{QSC\_KYBER\_SHAREDSECRET\_SIZE}}];}
\DoxyCodeLine{uint8\_t\ ssb[\mbox{\hyperlink{kyber_8h_ae7c6524a5c0bf0336df3af0f7d2eb297}{QSC\_KYBER\_SHAREDSECRET\_SIZE}}];}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ create\ the\ public\ and\ secret\ keys}}
\DoxyCodeLine{qsc\_kyber\_generate\_keypair(pk,\ sk);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ output\ the\ cipher-\/text\ (ct),\ and\ the\ shared\ secret\ (ssb)}}
\DoxyCodeLine{qsc\_kyber\_encapsulate(ssb,\ ct,\ pk);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ decrypt\ the\ cipher-\/text,\ and\ output\ the\ shared\ key\ (ssa)}}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_kyber\_decapsulate(ssa,\ ct,\ sk)\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ decapsulation\ failed,\ do\ something..}}
\DoxyCodeLine{\}}

\end{DoxyCode}

\end{DoxyParagraph}
\begin{DoxyRemark}{Remarks}
Based on the C reference branch of PQ-\/\+Crystals Kyber; including base code, comments, and api. ~\newline
Removed the K=2 parameter, and added a K=5. The NIST \textquotesingle{}512\textquotesingle{} parameter has fallen below the threshold required by NIST PQ S1 minimum. ~\newline
The new K5 parameter may have a better chance of long-\/term security, with only a small increase in cost. ~\newline
 Based entirely on the C reference branch of Dilithium taken from the NIST Post Quantum Competition Round 3 submission. ~\newline
The NIST Post Quantum Competition \href{https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions}{\texttt{ Round 3}} Finalists. ~\newline
The \href{https://pq-crystals.org/kyber/index.shtml}{\texttt{ Kyber}} website. ~\newline
The Kyber \href{https://pq-crystals.org/kyber/data/kyber-specification-round3-20210131.pdf}{\texttt{ Algorithm}} Specification. ~\newline

\end{DoxyRemark}


\doxysubsection{Function Documentation}
\Hypertarget{kyber_8h_a07e969adf524c02dfc8e069bc383f163}\index{kyber.h@{kyber.h}!qsc\_kyber\_decapsulate@{qsc\_kyber\_decapsulate}}
\index{qsc\_kyber\_decapsulate@{qsc\_kyber\_decapsulate}!kyber.h@{kyber.h}}
\doxysubsubsection{\texorpdfstring{qsc\_kyber\_decapsulate()}{qsc\_kyber\_decapsulate()}}
{\footnotesize\ttfamily \label{kyber_8h_a07e969adf524c02dfc8e069bc383f163} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+kyber\+\_\+decapsulate (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{secret}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{}\end{DoxyParamCaption})}



Decapsulates the shared secret for a given cipher-\/text using a private-\/key. Used in conjunction with the encapsulate function. 


\begin{DoxyParams}{Parameters}
{\em secret} & Pointer to the output shared secret key, an array of QSC\+\_\+\+KYBER\+\_\+\+SHAREDSECRET\+\_\+\+SIZE constant size \\
\hline
{\em ciphertext} & \mbox{[}const\mbox{]} Pointer to the cipher-\/text array of QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE constant size \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the secret-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PRIVATEKEY\+\_\+\+SIZE constant size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
\Hypertarget{kyber_8h_ac29729a9d20073fb5bf0caaf07e47513}\index{kyber.h@{kyber.h}!qsc\_kyber\_decrypt@{qsc\_kyber\_decrypt}}
\index{qsc\_kyber\_decrypt@{qsc\_kyber\_decrypt}!kyber.h@{kyber.h}}
\doxysubsubsection{\texorpdfstring{qsc\_kyber\_decrypt()}{qsc\_kyber\_decrypt()}}
{\footnotesize\ttfamily \label{kyber_8h_ac29729a9d20073fb5bf0caaf07e47513} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+kyber\+\_\+decrypt (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{secret}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{}\end{DoxyParamCaption})}



Decrypts the shared secret for a given cipher-\/text using a private-\/key Used in conjunction with the encrypt function. 


\begin{DoxyParams}{Parameters}
{\em secret} & Pointer to the output shared secret key, an array of QSC\+\_\+\+KYBER\+\_\+\+SHAREDSECRET\+\_\+\+SIZE constant size \\
\hline
{\em ciphertext} & \mbox{[}const\mbox{]} Pointer to the cipher-\/text array of QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE constant size \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the secret-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PRIVATEKEY\+\_\+\+SIZE constant size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
\Hypertarget{kyber_8h_a2846270dbee6004f92b992fa2b533908}\index{kyber.h@{kyber.h}!qsc\_kyber\_encapsulate@{qsc\_kyber\_encapsulate}}
\index{qsc\_kyber\_encapsulate@{qsc\_kyber\_encapsulate}!kyber.h@{kyber.h}}
\doxysubsubsection{\texorpdfstring{qsc\_kyber\_encapsulate()}{qsc\_kyber\_encapsulate()}}
{\footnotesize\ttfamily \label{kyber_8h_a2846270dbee6004f92b992fa2b533908} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+kyber\+\_\+encapsulate (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{secret}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates cipher-\/text and encapsulates a shared secret key using a public-\/key. Used in conjunction with the decapsulate function. 

\begin{DoxyWarning}{Warning}
Ciphertext array must be sized to the QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em secret} & Pointer to the shared secret key, a uint8\+\_\+t array of QSC\+\_\+\+KYBER\+\_\+\+SHAREDSECRET\+\_\+\+SIZE constant size \\
\hline
{\em ciphertext} & Pointer to the cipher-\/text array of QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE constant size \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PUBLICKEY\+\_\+\+SIZE constant size \\
\hline
{\em rng\+\_\+generate} & A pointer to the random generator function \\
\hline
\end{DoxyParams}
\Hypertarget{kyber_8h_a692db6b4a2e4ba5356b68380feca1494}\index{kyber.h@{kyber.h}!qsc\_kyber\_encrypt@{qsc\_kyber\_encrypt}}
\index{qsc\_kyber\_encrypt@{qsc\_kyber\_encrypt}!kyber.h@{kyber.h}}
\doxysubsubsection{\texorpdfstring{qsc\_kyber\_encrypt()}{qsc\_kyber\_encrypt()}}
{\footnotesize\ttfamily \label{kyber_8h_a692db6b4a2e4ba5356b68380feca1494} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+kyber\+\_\+encrypt (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{secret}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{const uint8\+\_\+t}]{seed}{\mbox{[}\+QSC\+\_\+\+KYBER\+\_\+\+SEED\+\_\+\+SIZE\mbox{]}}\end{DoxyParamCaption})}



Generates cipher-\/text and encapsulates a shared secret key using a public-\/key Used in conjunction with the encrypt function. 

\begin{DoxyWarning}{Warning}
Ciphertext array must be sized to the QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em secret} & Pointer to the shared secret key, a uint8\+\_\+t array of QSC\+\_\+\+KYBER\+\_\+\+SHAREDSECRET\+\_\+\+SIZE constant size \\
\hline
{\em ciphertext} & Pointer to the cipher-\/text array of QSC\+\_\+\+KYBER\+\_\+\+CIPHERTEXT\+\_\+\+SIZE constant size \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PUBLICKEY\+\_\+\+SIZE constant size \\
\hline
{\em seed} & \mbox{[}const\mbox{]} A pointer to the random seed array \\
\hline
\end{DoxyParams}
\Hypertarget{kyber_8h_a371669e2f7670c62f46402cad358f383}\index{kyber.h@{kyber.h}!qsc\_kyber\_generate\_keypair@{qsc\_kyber\_generate\_keypair}}
\index{qsc\_kyber\_generate\_keypair@{qsc\_kyber\_generate\_keypair}!kyber.h@{kyber.h}}
\doxysubsubsection{\texorpdfstring{qsc\_kyber\_generate\_keypair()}{qsc\_kyber\_generate\_keypair()}}
{\footnotesize\ttfamily \label{kyber_8h_a371669e2f7670c62f46402cad358f383} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+kyber\+\_\+generate\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates public and private key for the KYBER key encapsulation mechanism. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+KYBER\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+KYBER\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the output public-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PUBLICKEY\+\_\+\+SIZE constant size \\
\hline
{\em privatekey} & Pointer to output private-\/key array of QSC\+\_\+\+KYBER\+\_\+\+PRIVATEKEY\+\_\+\+SIZE constant size \\
\hline
{\em rng\+\_\+generate} & A pointer to the random generator function \\
\hline
\end{DoxyParams}
