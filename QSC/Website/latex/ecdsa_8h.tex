\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/ecdsa.h File Reference}
\hypertarget{ecdsa_8h}{}\label{ecdsa_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/ecdsa.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/ecdsa.h}}


Contains the primary public api for the ECDSA asymmetric signature scheme implementation.  


{\ttfamily \#include "{}common.\+h"{}}\newline
Include dependency graph for ecdsa.\+h\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{ecdsa_8h_a1fc3152184153b6440699dc34a393147}\label{ecdsa_8h_a1fc3152184153b6440699dc34a393147} 
\#define {\bfseries QSC\+\_\+\+ECDSA\+\_\+\+SEED\+\_\+\+SIZE}~32
\begin{DoxyCompactList}\small\item\em The byte size of the random seed array. \end{DoxyCompactList}\item 
\Hypertarget{ecdsa_8h_ae44879dc24135a2e63d21aa3d61f2170}\label{ecdsa_8h_ae44879dc24135a2e63d21aa3d61f2170} 
\#define {\bfseries QSC\+\_\+\+ECDSA\+\_\+\+ALGNAME}~"{}ECDSA"{}
\begin{DoxyCompactList}\small\item\em The formal algorithm name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{ecdsa_8h_a5cb7019a87307acc6cabd32215bff2be}{qsc\+\_\+ecdsa\+\_\+generate\+\_\+seeded\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}seed)
\begin{DoxyCompactList}\small\item\em Generates a ECDSA public/private key-\/pair. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{ecdsa_8h_acb610f9305bde8f9c0b86aa2681cee94}{qsc\+\_\+ecdsa\+\_\+generate\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates a ECDSA public/private key-\/pair. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{ecdsa_8h_afc4a30cea712bf823fb6f9255cc78651}{qsc\+\_\+ecdsa\+\_\+sign}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t \texorpdfstring{$\ast$}{*}smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey)
\begin{DoxyCompactList}\small\item\em Takes the message as input and returns an array containing the signature followed by the message. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{ecdsa_8h_af695383a08648a04c1ce7d039a3c2e18}{qsc\+\_\+ecdsa\+\_\+verify}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t \texorpdfstring{$\ast$}{*}msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey)
\begin{DoxyCompactList}\small\item\em Verifies a signature-\/message pair with the public key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains the primary public api for the ECDSA asymmetric signature scheme implementation. 

\begin{DoxyDate}{Date}
September 21, 2020
\end{DoxyDate}
\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ An\ example\ of\ key-\/pair\ creation,\ encryption,\ and\ decryption}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ MSGLEN\ 32}}
\DoxyCodeLine{uint8\_t\ pk[QSC\_ECDSA\_PUBLICKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ sk[QSC\_ECDSA\_SECRETKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ msg[32];}
\DoxyCodeLine{uint8\_t\ smsg[QSC\_ECDSA\_SIGNATURE\_SIZE\ +\ MSGLEN];}
\DoxyCodeLine{uint8\_t\ rmsg[32];}
\DoxyCodeLine{}
\DoxyCodeLine{uint32\_t\ rmsglen\ =\ 0;}
\DoxyCodeLine{uint32\_t\ smsglen\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ create\ the\ public\ and\ secret\ keys}}
\DoxyCodeLine{qsc\_ecdsa\_generate\_seeded\_keypair(pk,\ sk,\ random-\/seed);}
\DoxyCodeLine{\textcolor{comment}{//\ returns\ the\ signed\ the\ message\ in\ smsg}}
\DoxyCodeLine{qsc\_ecdsa\_sign(smsg,\ \&smsglen,\ msg,\ MSGLEN,\ sk);}
\DoxyCodeLine{\textcolor{comment}{//\ test\ the\ signature\ and\ return\ the\ message\ bytes\ in\ rmsg}}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_ecdsa\_verify(rmsg,\ \&rmsglen,\ smsg,\ smsglen,\ pk)\ !=\ \textcolor{keyword}{true})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ authentication\ failed,\ do\ something..}}
\DoxyCodeLine{\}}

\end{DoxyCode}

\end{DoxyParagraph}
Reference implementations\+: Lib\+Sodium by Frank Denis \texorpdfstring{$<$}{<}a href="{}https\+://github.\+com/jedisct1/libsodium"{} /a\texorpdfstring{$>$}{>} curve25519-\/donna by Adam Langley \texorpdfstring{$<$}{<}a href="{}https\+://github.\+com/agl/curve25519-\/donna"{} /a\texorpdfstring{$>$}{>} Na\+CI by Daniel J. Bernstein, Tanja Lange, Peter Schwabe \texorpdfstring{$<$}{<}a href="{}https\+://nacl.\+cr.\+yp.\+to"{} /a\texorpdfstring{$>$}{>}

Rewritten for Misra compliance and library integration by John G. Underhill September 21, 2020 

\doxysubsection{Function Documentation}
\Hypertarget{ecdsa_8h_acb610f9305bde8f9c0b86aa2681cee94}\index{ecdsa.h@{ecdsa.h}!qsc\_ecdsa\_generate\_keypair@{qsc\_ecdsa\_generate\_keypair}}
\index{qsc\_ecdsa\_generate\_keypair@{qsc\_ecdsa\_generate\_keypair}!ecdsa.h@{ecdsa.h}}
\doxysubsubsection{\texorpdfstring{qsc\_ecdsa\_generate\_keypair()}{qsc\_ecdsa\_generate\_keypair()}}
{\footnotesize\ttfamily \label{ecdsa_8h_acb610f9305bde8f9c0b86aa2681cee94} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+ecdsa\+\_\+generate\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates a ECDSA public/private key-\/pair. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+ECDSA\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+ECDSA\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the public verification-\/key array \\
\hline
{\em privatekey} & Pointer to the private signature-\/key array \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{ecdsa_8h_a5cb7019a87307acc6cabd32215bff2be}\index{ecdsa.h@{ecdsa.h}!qsc\_ecdsa\_generate\_seeded\_keypair@{qsc\_ecdsa\_generate\_seeded\_keypair}}
\index{qsc\_ecdsa\_generate\_seeded\_keypair@{qsc\_ecdsa\_generate\_seeded\_keypair}!ecdsa.h@{ecdsa.h}}
\doxysubsubsection{\texorpdfstring{qsc\_ecdsa\_generate\_seeded\_keypair()}{qsc\_ecdsa\_generate\_seeded\_keypair()}}
{\footnotesize\ttfamily \label{ecdsa_8h_a5cb7019a87307acc6cabd32215bff2be} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+ecdsa\+\_\+generate\+\_\+seeded\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{seed}{}\end{DoxyParamCaption})}



Generates a ECDSA public/private key-\/pair. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+ECDSA\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+ECDSA\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the public verification-\/key array \\
\hline
{\em privatekey} & Pointer to the private signature-\/key array \\
\hline
{\em seed} & \mbox{[}const\mbox{]} Pointer to the random 32-\/byte seed array \\
\hline
\end{DoxyParams}
\Hypertarget{ecdsa_8h_afc4a30cea712bf823fb6f9255cc78651}\index{ecdsa.h@{ecdsa.h}!qsc\_ecdsa\_sign@{qsc\_ecdsa\_sign}}
\index{qsc\_ecdsa\_sign@{qsc\_ecdsa\_sign}!ecdsa.h@{ecdsa.h}}
\doxysubsubsection{\texorpdfstring{qsc\_ecdsa\_sign()}{qsc\_ecdsa\_sign()}}
{\footnotesize\ttfamily \label{ecdsa_8h_afc4a30cea712bf823fb6f9255cc78651} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+ecdsa\+\_\+sign (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{}\end{DoxyParamCaption})}



Takes the message as input and returns an array containing the signature followed by the message. 

\begin{DoxyWarning}{Warning}
Signature array must be sized to the size of the message plus QSC\+\_\+\+ECDSA\+\_\+\+SIGNATURE\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em signedmsg} & Pointer to the signed-\/message array \\
\hline
{\em smsglen} & \mbox{[}const\mbox{]} Pointer to the signed message length \\
\hline
{\em message} & Pointer to the message array \\
\hline
{\em msglen} & The message length \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the private signature-\/key array \\
\hline
\end{DoxyParams}
\Hypertarget{ecdsa_8h_af695383a08648a04c1ce7d039a3c2e18}\index{ecdsa.h@{ecdsa.h}!qsc\_ecdsa\_verify@{qsc\_ecdsa\_verify}}
\index{qsc\_ecdsa\_verify@{qsc\_ecdsa\_verify}!ecdsa.h@{ecdsa.h}}
\doxysubsubsection{\texorpdfstring{qsc\_ecdsa\_verify()}{qsc\_ecdsa\_verify()}}
{\footnotesize\ttfamily \label{ecdsa_8h_af695383a08648a04c1ce7d039a3c2e18} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+ecdsa\+\_\+verify (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{}\end{DoxyParamCaption})}



Verifies a signature-\/message pair with the public key. 


\begin{DoxyParams}{Parameters}
{\em message} & Pointer to the message array to be signed \\
\hline
{\em msglen} & Pointer to the message length \\
\hline
{\em signedmsg} & \mbox{[}const\mbox{]} Pointer to the signed message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public verification-\/key array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
