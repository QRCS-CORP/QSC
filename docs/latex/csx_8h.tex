\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/csx.h File Reference}
\hypertarget{csx_8h}{}\label{csx_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/csx.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/csx.h}}


Cha\+Cha-\/based authenticated Stream cipher e\+Xtension.  


{\ttfamily \#include "{}common.\+h"{}}\newline
{\ttfamily \#include "{}sha3.\+h"{}}\newline
{\ttfamily \#include "{}pmac.\+h"{}}\newline
Include dependency graph for csx.\+h\+:
% FIG 0
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structqsc__csx__keyparams}{qsc\+\_\+csx\+\_\+keyparams}}
\begin{DoxyCompactList}\small\item\em The key parameters structure containing key, nonce, and info arrays and lengths. Use this structure to load an input cipher-\/key and optional info tweak, using the qsc\+\_\+csx\+\_\+initialize function. Keys must be random and secret, and align to the corresponding key size of the cipher implemented. The info parameter is optional, and can be a salt or cryptographic key. The nonce is always QSC\+\_\+\+CSX\+\_\+\+BLOCK\+\_\+\+SIZE in length. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The internal state structure containing the round-\/key array. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{csx_8h_a41abb38a317351ca70b7c29ae8edc25c}\label{csx_8h_a41abb38a317351ca70b7c29ae8edc25c} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+AUTHENTICATED}
\begin{DoxyCompactList}\small\item\em Enables KMAC authentication mode. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a850e1349b50f15a7a96aff6751a06aab}\label{csx_8h_a850e1349b50f15a7a96aff6751a06aab} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+AUTH\+\_\+\+PMAC}
\begin{DoxyCompactList}\small\item\em Enables the reduced rounds PMAC implementation. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a801f494563418072c7cac15f53deea0d}\label{csx_8h_a801f494563418072c7cac15f53deea0d} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+BLOCK\+\_\+\+SIZE}~128
\begin{DoxyCompactList}\small\item\em The internal block size in bytes, required by the encryption and decryption functions. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a8966fccfdb20447b1c03ba7672e8f9e6}\label{csx_8h_a8966fccfdb20447b1c03ba7672e8f9e6} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+INFO\+\_\+\+SIZE}~48
\begin{DoxyCompactList}\small\item\em The maximum byte length of the info string. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a422344e80cc04e590c8a278a5a6263e5}\label{csx_8h_a422344e80cc04e590c8a278a5a6263e5} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+KEY\+\_\+\+SIZE}~64
\begin{DoxyCompactList}\small\item\em The size in bytes of the CSX-\/512 input cipher-\/key. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a1a17ebd1d3e6440e22b01c03e23d7fc3}\label{csx_8h_a1a17ebd1d3e6440e22b01c03e23d7fc3} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+MAC\+\_\+\+SIZE}~32
\begin{DoxyCompactList}\small\item\em The CSX MAC code array length in bytes. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_aaad87d0d2b87a9c27c9a6de576636de7}\label{csx_8h_aaad87d0d2b87a9c27c9a6de576636de7} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+NONCE\+\_\+\+SIZE}~16
\begin{DoxyCompactList}\small\item\em The byte size of the nonce array. \end{DoxyCompactList}\item 
\Hypertarget{csx_8h_a85063a4106ffb3e7972b618da25aee65}\label{csx_8h_a85063a4106ffb3e7972b618da25aee65} 
\#define {\bfseries QSC\+\_\+\+CSX\+\_\+\+STATE\+\_\+\+SIZE}~16
\begin{DoxyCompactList}\small\item\em The uint64 size of the internal state array. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{csx_8h_a8b31ea0f6668281d4655cf44e101f25c}{qsc\+\_\+csx\+\_\+dispose}} (\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Dispose of the CSX cipher state. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{csx_8h_a9f4402e25572adb9ac6860c4b17e75ad}{qsc\+\_\+csx\+\_\+initialize}} (\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}ctx, const \mbox{\hyperlink{structqsc__csx__keyparams}{qsc\+\_\+csx\+\_\+keyparams}} \texorpdfstring{$\ast$}{*}keyparams, bool encryption)
\begin{DoxyCompactList}\small\item\em Initialize the state with the input cipher-\/key and optional info tweak. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{csx_8h_a5eb9d323b45bef12eabe68852a136be6}{qsc\+\_\+csx\+\_\+set\+\_\+associated}} (\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}data, size\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Set the associated data string used in authenticating the message. The associated data may be packet header information, domain specific data, or a secret shared by a group. The associated data must be set after initialization, and before each transformation call. The data is erased after each call to the transform. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{csx_8h_a071d11fa66ebccee8e8fc7ae9bc58696}{qsc\+\_\+csx\+\_\+transform}} (\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input, size\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Transform an array of bytes. In encryption mode, the input plain-\/text is encrypted and then an authentication MAC code is appended to the cipher-\/text. In decryption mode, the input cipher-\/text is authenticated internally and compared to the MAC code appended to the cipher-\/text, if the codes to not match, the cipher-\/text is not decrypted and the call fails. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{csx_8h_ab70bbd32fd86948d6206b1c48b75deea}{qsc\+\_\+csx\+\_\+extended\+\_\+transform}} (\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input, size\+\_\+t length, bool finalize)
\begin{DoxyCompactList}\small\item\em A multi-\/call transform for a large array of bytes, such as required by file encryption. This call can be used to transform and authenticate a very large array of bytes (+1GB). On the last call in the sequence, set the finalize parameter to true to complete authentication, and write the MAC code to the end of the output array in encryption mode, or compare to the embedded MAC code and authenticate in decryption mode. In encryption mode, the input plain-\/text is encrypted, then authenticated, and the MAC code is appended to the cipher-\/text. In decryption mode, the input cipher-\/text is authenticated internally and compared to the MAC code appended to the cipher-\/text, if the codes to not match, the cipher-\/text is not decrypted and the call fails. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Cha\+Cha-\/based authenticated Stream cipher e\+Xtension. 

\begin{DoxyAuthor}{Author}
John G. Underhill 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+0.\+0.\+0b 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
May 2, 2020 updated October 13, 2021 contact\+: \href{mailto:john.underhill@protonmail.com}{\texttt{ john.\+underhill@protonmail.\+com}}
\end{DoxyDate}
CSX-\/512 encryption example ~\newline

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ external\ message,\ key,\ nonce,\ and\ custom-\/info\ arrays}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ CSTLEN\ 20}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ MSGLEN\ 200}}
\DoxyCodeLine{uint8\_t\ cust[CSTLEN]\ =\ \{...\};}
\DoxyCodeLine{uint8\_t\ key[\mbox{\hyperlink{csx_8h_a422344e80cc04e590c8a278a5a6263e5}{QSC\_CSX\_KEY\_SIZE}}]\ =\ \{...\};}
\DoxyCodeLine{uint8\_t\ msg[MSGLEN]\ =\ \{...\};}
\DoxyCodeLine{uint8\_t\ nonce[\mbox{\hyperlink{csx_8h_aaad87d0d2b87a9c27c9a6de576636de7}{QSC\_CSX\_NONCE\_SIZE}}]\ =\ \{...\};}
\DoxyCodeLine{...}
\DoxyCodeLine{uint8\_t\ cpt[MSGLEN\ +\ \mbox{\hyperlink{csx_8h_a1a17ebd1d3e6440e22b01c03e23d7fc3}{QSC\_CSX\_MAC\_SIZE}}]\ =\ \{\ 0\ \};}
\DoxyCodeLine{\mbox{\hyperlink{structqsc__csx__state}{qsc\_csx\_state}}\ state;}
\DoxyCodeLine{\mbox{\hyperlink{structqsc__csx__keyparams}{qsc\_csx\_keyparams}}\ kp\ =\ \{\ key,\ \mbox{\hyperlink{csx_8h_a422344e80cc04e590c8a278a5a6263e5}{QSC\_CSX\_KEY\_SIZE}},\ nonce,\ cust,\ CSTLEN\ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ initialize\ the\ state}}
\DoxyCodeLine{qsc\_csx\_initialize(\&state,\ \&kp,\ \textcolor{keyword}{true});}
\DoxyCodeLine{\textcolor{comment}{//\ encrypt\ the\ message}}
\DoxyCodeLine{qsc\_csx\_transform(\&state,\ cpt,\ msg,\ MSGLEN)}

\end{DoxyCode}


CSX-\/512 decryption example ~\newline

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ external\ cipher-\/text,\ key\ and\ custom-\/info\ arrays,}}
\DoxyCodeLine{\textcolor{comment}{//\ and\ cipher-\/text\ containing\ the\ encrypted\ plain-\/text\ and\ the\ mac-\/code}}
\DoxyCodeLine{uint8\_t\ cpt[CPT\_LEN]\ =\ \{\ qsc\_csx\_transform(k,p)\ \}}
\DoxyCodeLine{uint8\_t\ key[\mbox{\hyperlink{csx_8h_a422344e80cc04e590c8a278a5a6263e5}{QSC\_CSX\_KEY\_SIZE}}]\ =\ \{...\};}
\DoxyCodeLine{uint8\_t\ nonce[\mbox{\hyperlink{csx_8h_aaad87d0d2b87a9c27c9a6de576636de7}{QSC\_CSX\_NONCE\_SIZE}}]\ =\ \{...\};}
\DoxyCodeLine{uint8\_t\ cust[CSTLEN]\ =\ \{...\};}
\DoxyCodeLine{...}
\DoxyCodeLine{\textcolor{comment}{//\ subtract\ the\ mac-\/code\ length\ from\ the\ overall\ cipher-\/text\ length\ for\ the\ message\ size}}
\DoxyCodeLine{const\ \textcolor{keywordtype}{size\_t}\ MSGLEN\ =\ CPT\_LEN\ -\/\ \mbox{\hyperlink{csx_8h_a1a17ebd1d3e6440e22b01c03e23d7fc3}{QSC\_CSX\_MAC\_SIZE}};}
\DoxyCodeLine{uint8\_t\ msg[MSGLEN]\ =\ \{\ 0\ \};}
\DoxyCodeLine{\mbox{\hyperlink{structqsc__csx__keyparams}{qsc\_csx\_keyparams}}\ kp\ =\ \{\ key,\ \mbox{\hyperlink{csx_8h_a422344e80cc04e590c8a278a5a6263e5}{QSC\_CSX\_KEY\_SIZE}},\ nonce,\ cust,\ CSTLEN\ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ initialize\ the\ cipher\ state\ for\ decryption}}
\DoxyCodeLine{qsc\_csx\_initialize(\&state,\ \&kp,\ \textcolor{keyword}{false});}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ authenticate\ and\ decrypt\ the\ cipher-\/text}}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_csx\_transform(\&state,\ msg,\ cpt,\ MSGLEN)\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ authentication\ has\ failed,\ do\ something..}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\begin{DoxyRemark}{Remarks}

\end{DoxyRemark}
\begin{DoxyParagraph}{}
An \mbox{[}EXPERIMENTAL\mbox{]} vectorized, 64-\/bit, 40-\/round stream cipher \mbox{[}CSX512\mbox{]} implementation based on Cha\+Cha. This cipher uses KMAC-\/512 to authenticate the cipher-\/text stream in an encrypt-\/then-\/mac authentication configuration. The CSX (authenticated Cipher Stream, Cha\+Cha e\+Xtended) cipher, is a hybrid of the Cha\+Cha stream cipher, using 64-\/bit integers, a 1024-\/bit block and a 512-\/bit key. ~\newline
 
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
The pseudo-\/random bytes generator used by this cipher is the Keccak c\+SHAKE extended output function (XOF). The c\+SHAKE XOF is implemented in the 512-\/bit form of that function, and used to expand the input cipher-\/key into the cipher and MAC keys. CSX-\/512 uses a 512-\/bit input key, an a 16 byte nonce, and an optional tweak; the info parameter, up to 48 bytes in length.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
This is a \textquotesingle{}tweakable cipher\textquotesingle{}, the initialization parameters; \doxylink{structqsc__csx__keyparams}{qsc\+\_\+csx\+\_\+keyparams}, include an info parameter that can be used as a secondary user input. Internally, the info parameter is used to customize the c\+SHAKE output, using the c\+SHAKE \textquotesingle{}custom\textquotesingle{} parameter to pre-\/initialize the SHAKE state. The info parameter can be tweaked, with a user defined string \textquotesingle{}info\textquotesingle{} in an \doxylink{structqsc__csx__keyparams}{qsc\+\_\+csx\+\_\+keyparams} structure passed to the csx\+\_\+intitialize(state,keyparams,encrypt). This tweak can be used as a \textquotesingle{}domain key\textquotesingle{}, or to differentiate cipher-\/text output from other implementations, or as a secondary secret-\/key input.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
CSX is an authenticated encryption with associated data (AEAD) stream cipher. The c\+SHAKE key-\/expansion function generates a key for the keyed hash-\/based MAC function; KMAC, used to generate the authentication code, which is appended to the cipher-\/text output of an encryption call. In decryption mode, before decryption is performed, an internal mac code is calculated, and compared to the code embedded in the cipher-\/text. If authentication fails, the cipher-\/text is not decrypted, and the qsc\+\_\+csx\+\_\+transform(state,out,in,inlen) function returns a boolean false value. The qsc\+\_\+csx\+\_\+set\+\_\+associated(state,in,inlen) function can be used to add additional data to the MAC generators input, like packet-\/header data, or a custom code or counter.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
For authentication CSX can use either the standard form of KMAC, which uses 24 rounds, or the default authentication setting; a reduced-\/rounds version of KMAC that uses half the number of permutation rounds KMAC-\/\+R12. To enable the standard from of KMAC, pass the QSC\+\_\+\+RCS\+\_\+\+AUTH\+\_\+\+KMACR24 as a compiler definition, or unrem the definition in this header file. To run CSX without authentication, remove the QSC\+\_\+\+RCS\+\_\+\+AUTHENTICATED in this header file.
\end{DoxyParagraph}
\begin{DoxyParagraph}{}
The CSX-\/512, known answer vectors are taken from the CEX++ cryptographic library \href{https://github.com/Steppenwolfe65/CEX}{\texttt{ The CEX++ Cryptographic Library}}. ~\newline
See the documentation and the csx\+\_\+test.\+h tests for usage examples. 
\end{DoxyParagraph}


\doxysubsection{Function Documentation}
\Hypertarget{csx_8h_a8b31ea0f6668281d4655cf44e101f25c}\index{csx.h@{csx.h}!qsc\_csx\_dispose@{qsc\_csx\_dispose}}
\index{qsc\_csx\_dispose@{qsc\_csx\_dispose}!csx.h@{csx.h}}
\doxysubsubsection{\texorpdfstring{qsc\_csx\_dispose()}{qsc\_csx\_dispose()}}
{\footnotesize\ttfamily \label{csx_8h_a8b31ea0f6668281d4655cf44e101f25c} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+csx\+\_\+dispose (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Dispose of the CSX cipher state. 

\begin{DoxyWarning}{Warning}
The dispose function must be called when disposing of the cipher. This function destroys the internal state of the cipher.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em ctx} & \mbox{[}struct\mbox{]} The cipher state structure \\
\hline
\end{DoxyParams}
\Hypertarget{csx_8h_ab70bbd32fd86948d6206b1c48b75deea}\index{csx.h@{csx.h}!qsc\_csx\_extended\_transform@{qsc\_csx\_extended\_transform}}
\index{qsc\_csx\_extended\_transform@{qsc\_csx\_extended\_transform}!csx.h@{csx.h}}
\doxysubsubsection{\texorpdfstring{qsc\_csx\_extended\_transform()}{qsc\_csx\_extended\_transform()}}
{\footnotesize\ttfamily \label{csx_8h_ab70bbd32fd86948d6206b1c48b75deea} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+csx\+\_\+extended\+\_\+transform (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{, }\item[{size\+\_\+t}]{length}{, }\item[{bool}]{finalize}{}\end{DoxyParamCaption})}



A multi-\/call transform for a large array of bytes, such as required by file encryption. This call can be used to transform and authenticate a very large array of bytes (+1GB). On the last call in the sequence, set the finalize parameter to true to complete authentication, and write the MAC code to the end of the output array in encryption mode, or compare to the embedded MAC code and authenticate in decryption mode. In encryption mode, the input plain-\/text is encrypted, then authenticated, and the MAC code is appended to the cipher-\/text. In decryption mode, the input cipher-\/text is authenticated internally and compared to the MAC code appended to the cipher-\/text, if the codes to not match, the cipher-\/text is not decrypted and the call fails. 

\begin{DoxyWarning}{Warning}
The cipher must be initialized before this function can be called
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em ctx} & \mbox{[}struct\mbox{]} The cipher state structure \\
\hline
{\em output} & A pointer to the output array \\
\hline
{\em input} & \mbox{[}const\mbox{]} A pointer to the input array \\
\hline
{\em length} & The number of bytes to transform \\
\hline
{\em finalize} & Complete authentication on a stream if set to true\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: Returns true if the cipher has been transformed the data successfully, false on failure 
\end{DoxyReturn}
\Hypertarget{csx_8h_a9f4402e25572adb9ac6860c4b17e75ad}\index{csx.h@{csx.h}!qsc\_csx\_initialize@{qsc\_csx\_initialize}}
\index{qsc\_csx\_initialize@{qsc\_csx\_initialize}!csx.h@{csx.h}}
\doxysubsubsection{\texorpdfstring{qsc\_csx\_initialize()}{qsc\_csx\_initialize()}}
{\footnotesize\ttfamily \label{csx_8h_a9f4402e25572adb9ac6860c4b17e75ad} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+csx\+\_\+initialize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const \mbox{\hyperlink{structqsc__csx__keyparams}{qsc\+\_\+csx\+\_\+keyparams}} \texorpdfstring{$\ast$}{*}}]{keyparams}{, }\item[{bool}]{encryption}{}\end{DoxyParamCaption})}



Initialize the state with the input cipher-\/key and optional info tweak. 


\begin{DoxyParams}{Parameters}
{\em ctx} & \mbox{[}struct\mbox{]} The cipher state structure \\
\hline
{\em keyparams} & \mbox{[}const\mbox{]}\mbox{[}struct\mbox{]} The secret input cipher-\/key and nonce structure \\
\hline
{\em encryption} & Initialize the cipher for encryption, or false for decryption mode \\
\hline
\end{DoxyParams}
\Hypertarget{csx_8h_a5eb9d323b45bef12eabe68852a136be6}\index{csx.h@{csx.h}!qsc\_csx\_set\_associated@{qsc\_csx\_set\_associated}}
\index{qsc\_csx\_set\_associated@{qsc\_csx\_set\_associated}!csx.h@{csx.h}}
\doxysubsubsection{\texorpdfstring{qsc\_csx\_set\_associated()}{qsc\_csx\_set\_associated()}}
{\footnotesize\ttfamily \label{csx_8h_a5eb9d323b45bef12eabe68852a136be6} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+csx\+\_\+set\+\_\+associated (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{data}{, }\item[{size\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Set the associated data string used in authenticating the message. The associated data may be packet header information, domain specific data, or a secret shared by a group. The associated data must be set after initialization, and before each transformation call. The data is erased after each call to the transform. 

\begin{DoxyWarning}{Warning}
The cipher must be initialized before this function can be called
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em ctx} & \mbox{[}struct\mbox{]} The cipher state structure \\
\hline
{\em data} & \mbox{[}const\mbox{]} The associated data array \\
\hline
{\em length} & The associated data array length \\
\hline
\end{DoxyParams}
\Hypertarget{csx_8h_a071d11fa66ebccee8e8fc7ae9bc58696}\index{csx.h@{csx.h}!qsc\_csx\_transform@{qsc\_csx\_transform}}
\index{qsc\_csx\_transform@{qsc\_csx\_transform}!csx.h@{csx.h}}
\doxysubsubsection{\texorpdfstring{qsc\_csx\_transform()}{qsc\_csx\_transform()}}
{\footnotesize\ttfamily \label{csx_8h_a071d11fa66ebccee8e8fc7ae9bc58696} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+csx\+\_\+transform (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqsc__csx__state}{qsc\+\_\+csx\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{, }\item[{size\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Transform an array of bytes. In encryption mode, the input plain-\/text is encrypted and then an authentication MAC code is appended to the cipher-\/text. In decryption mode, the input cipher-\/text is authenticated internally and compared to the MAC code appended to the cipher-\/text, if the codes to not match, the cipher-\/text is not decrypted and the call fails. 

\begin{DoxyWarning}{Warning}
The cipher must be initialized before this function can be called
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em ctx} & \mbox{[}struct\mbox{]} The cipher state structure \\
\hline
{\em output} & A pointer to the output array \\
\hline
{\em input} & \mbox{[}const\mbox{]} A pointer to the input array \\
\hline
{\em length} & The number of bytes to transform\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: Returns true if the cipher has been transformed the data successfully, false on failure 
\end{DoxyReturn}
