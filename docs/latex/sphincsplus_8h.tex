\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/sphincsplus.h File Reference}
\hypertarget{sphincsplus_8h}{}\label{sphincsplus_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/sphincsplus.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/sphincsplus.h}}


The Sphincs\+Plus API definitions ~\newline
Contains the primary public api for the Sphincs+ asymmetric signature scheme implementation.  


{\ttfamily \#include "{}common.\+h"{}}\newline
Include dependency graph for sphincsplus.\+h\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{sphincsplus_8h_a4d603a6e6148747af2bd714a77dbc059}\label{sphincsplus_8h_a4d603a6e6148747af2bd714a77dbc059} 
\#define {\bfseries QSC\+\_\+\+SPHINCSPLUS\+\_\+\+ALGNAME}~"{}SPHINCSPLUS"{}
\begin{DoxyCompactList}\small\item\em The formal algorithm name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{sphincsplus_8h_a3dc132b2ade05157742c7ca4497742b1}{qsc\+\_\+sphincsplus\+\_\+generate\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates a Sphincs+ public/private key-\/pair. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{sphincsplus_8h_a12c5ae73878dbe9f762db4c21d974772}{qsc\+\_\+sphincsplus\+\_\+sign}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t \texorpdfstring{$\ast$}{*}smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Takes the message as input and returns an array containing the signature followed by the message. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{sphincsplus_8h_ada7b4f79e0ddb2b40aab039f3385554e}{qsc\+\_\+sphincsplus\+\_\+verify}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t \texorpdfstring{$\ast$}{*}msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey)
\begin{DoxyCompactList}\small\item\em Verifies a signature-\/message pair with the public key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The Sphincs\+Plus API definitions ~\newline
Contains the primary public api for the Sphincs+ asymmetric signature scheme implementation. 

\begin{DoxyDate}{Date}
June 14, 2018 updated July 2, 2021
\end{DoxyDate}


\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ MSGLEN\ 32}}
\DoxyCodeLine{uint8\_t\ pk[QSC\_SPHINCSPLUS\_PUBLICKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ sk[QSC\_SPHINCSPLUS\_SECRETKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ msg[32];}
\DoxyCodeLine{uint8\_t\ smsg[QSC\_SPHINCSPLUS\_SIGNATURE\_SIZE\ +\ MSGLEN];}
\DoxyCodeLine{uint8\_t\ rmsg[32];}
\DoxyCodeLine{uint32\_t\ rmsglen\ =\ 0;}
\DoxyCodeLine{uint32\_t\ smsglen\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{qsc\_sphincsplus\_generate(pk,\ sk);}
\DoxyCodeLine{qsc\_sphincsplus\_sign(smsg,\ \&smsglen,\ msg,\ MSGLEN,\ sk);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_sphincsplus\_verify(rmsg,\ \&rmsglen,\ smsg,\ smsglen,\ pk)\ !=\ \textcolor{keyword}{true})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ authentication\ failed,\ \textcolor{keywordflow}{do}\ something..}
\DoxyCodeLine{\}}

\end{DoxyCode}

\end{DoxyParagraph}
Based entirely on the C reference branch of SPHINCS+ taken from the NIST Post Quantum Competition Round 3 submission. ~\newline
The NIST Post Quantum Competition \href{https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions}{\texttt{ Round 3}} Finalists. ~\newline
The \href{https://sphincs.org/}{\texttt{ SPHINCS+}} website. ~\newline
The SPHINCS+ \href{https://sphincs.org/data/sphincs+-specification.pdf}{\texttt{ Algorithm}} Specification. ~\newline


\doxysubsection{Function Documentation}
\Hypertarget{sphincsplus_8h_a3dc132b2ade05157742c7ca4497742b1}\index{sphincsplus.h@{sphincsplus.h}!qsc\_sphincsplus\_generate\_keypair@{qsc\_sphincsplus\_generate\_keypair}}
\index{qsc\_sphincsplus\_generate\_keypair@{qsc\_sphincsplus\_generate\_keypair}!sphincsplus.h@{sphincsplus.h}}
\doxysubsubsection{\texorpdfstring{qsc\_sphincsplus\_generate\_keypair()}{qsc\_sphincsplus\_generate\_keypair()}}
{\footnotesize\ttfamily \label{sphincsplus_8h_a3dc132b2ade05157742c7ca4497742b1} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+sphincsplus\+\_\+generate\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates a Sphincs+ public/private key-\/pair. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+SPHINCSPLUS\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+SPHINCSPLUS\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the public verification-\/key array \\
\hline
{\em privatekey} & Pointer to the private signature-\/key array \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{sphincsplus_8h_a12c5ae73878dbe9f762db4c21d974772}\index{sphincsplus.h@{sphincsplus.h}!qsc\_sphincsplus\_sign@{qsc\_sphincsplus\_sign}}
\index{qsc\_sphincsplus\_sign@{qsc\_sphincsplus\_sign}!sphincsplus.h@{sphincsplus.h}}
\doxysubsubsection{\texorpdfstring{qsc\_sphincsplus\_sign()}{qsc\_sphincsplus\_sign()}}
{\footnotesize\ttfamily \label{sphincsplus_8h_a12c5ae73878dbe9f762db4c21d974772} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+sphincsplus\+\_\+sign (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Takes the message as input and returns an array containing the signature followed by the message. 

\begin{DoxyWarning}{Warning}
Signature array must be sized to the size of the message plus QSC\+\_\+\+SPHINCSPLUS\+\_\+\+SIGNATURE\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em signedmsg} & Pointer to the signed-\/message array \\
\hline
{\em smsglen} & \mbox{[}const\mbox{]} Pointer to the signed message length \\
\hline
{\em message} & Pointer to the message array \\
\hline
{\em msglen} & The message length \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the private signature-\/key array \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{sphincsplus_8h_ada7b4f79e0ddb2b40aab039f3385554e}\index{sphincsplus.h@{sphincsplus.h}!qsc\_sphincsplus\_verify@{qsc\_sphincsplus\_verify}}
\index{qsc\_sphincsplus\_verify@{qsc\_sphincsplus\_verify}!sphincsplus.h@{sphincsplus.h}}
\doxysubsubsection{\texorpdfstring{qsc\_sphincsplus\_verify()}{qsc\_sphincsplus\_verify()}}
{\footnotesize\ttfamily \label{sphincsplus_8h_ada7b4f79e0ddb2b40aab039f3385554e} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+sphincsplus\+\_\+verify (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{}\end{DoxyParamCaption})}



Verifies a signature-\/message pair with the public key. 


\begin{DoxyParams}{Parameters}
{\em message} & Pointer to the message array to be signed \\
\hline
{\em msglen} & Pointer to the message length \\
\hline
{\em signedmsg} & \mbox{[}const\mbox{]} Pointer to the signed message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public verification-\/key array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
