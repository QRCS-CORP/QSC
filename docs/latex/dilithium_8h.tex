\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSC/\+QSC/dilithium.h File Reference}
\hypertarget{dilithium_8h}{}\label{dilithium_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/dilithium.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/dilithium.h}}


Contains the primary public api for the Dilithium asymmetric signature scheme implementation updated July 2, 2021.  


{\ttfamily \#include "{}common.\+h"{}}\newline
Include dependency graph for dilithium.\+h\+:
% FIG 0
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{dilithium_8h_aa686ee483dc9c15d3ec1fe9b08adc12d}\label{dilithium_8h_aa686ee483dc9c15d3ec1fe9b08adc12d} 
\#define {\bfseries QSC\+\_\+\+DILITHIUM\+\_\+\+ALGNAME}~"{}DILITHIUM"{}
\begin{DoxyCompactList}\small\item\em The formal algorithm name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{dilithium_8h_ad10e76933ac05bda319ad04dc13f150b}{qsc\+\_\+dilithium\+\_\+generate\+\_\+keypair}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey, uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Generates a Dilithium public/private key-\/pair. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{dilithium_8h_acf2512952ca0d01682821d5ccdfb9a24}{qsc\+\_\+dilithium\+\_\+sign}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t \texorpdfstring{$\ast$}{*}smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}privatekey, bool(\texorpdfstring{$\ast$}{*}rng\+\_\+generate)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t))
\begin{DoxyCompactList}\small\item\em Takes the message as input and returns an array containing the signature followed by the message. \end{DoxyCompactList}\item 
QSC\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{dilithium_8h_a21aa65b5873462ff3ae1d91fcc149c2d}{qsc\+\_\+dilithium\+\_\+verify}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t \texorpdfstring{$\ast$}{*}msglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signedmsg, size\+\_\+t smsglen, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}publickey)
\begin{DoxyCompactList}\small\item\em Verifies a signature-\/message pair with the public key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains the primary public api for the Dilithium asymmetric signature scheme implementation updated July 2, 2021. 

\begin{DoxyParagraph}{Example}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ An\ example\ of\ key-\/pair\ creation,\ encryption,\ and\ decryption}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define\ MSGLEN\ 32}}
\DoxyCodeLine{uint8\_t\ pk[QSC\_DILITHIUM\_PUBLICKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ sk[QSC\_DILITHIUM\_SECRETKEY\_SIZE];}
\DoxyCodeLine{uint8\_t\ msg[32];}
\DoxyCodeLine{uint8\_t\ smsg[QSC\_DILITHIUM\_SIGNATURE\_SIZE\ +\ MSGLEN];}
\DoxyCodeLine{uint8\_t\ rmsg[32];}
\DoxyCodeLine{}
\DoxyCodeLine{uint32\_t\ rmsglen\ =\ 0;}
\DoxyCodeLine{uint32\_t\ smsglen\ =\ 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ create\ the\ public\ and\ secret\ keys}}
\DoxyCodeLine{qsc\_dilithium\_generate(pk,\ sk);}
\DoxyCodeLine{\textcolor{comment}{//\ returns\ the\ signed\ the\ message\ in\ smsg}}
\DoxyCodeLine{qsc\_dilithium\_sign(smsg,\ \&smsglen,\ msg,\ MSGLEN,\ sk);}
\DoxyCodeLine{\textcolor{comment}{//\ test\ the\ signature\ and\ return\ the\ message\ bytes\ in\ rmsg}}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (qsc\_dilithium\_verify(rmsg,\ \&rmsglen,\ smsg,\ smsglen,\ pk)\ !=\ \textcolor{keyword}{true})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ authentication\ failed,\ do\ something..}}
\DoxyCodeLine{\}}

\end{DoxyCode}

\end{DoxyParagraph}
\begin{DoxyRemark}{Remarks}
Based entirely on the C reference branch of Dilithium taken from the NIST Post Quantum Competition Round 3 submission. ~\newline
The NIST Post Quantum Competition \href{https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions}{\texttt{ Round 3}} Finalists. ~\newline
The \href{https://pq-crystals.org/dilithium/index.shtml}{\texttt{ Dilithium}} web-\/site. ~\newline
The Dilithium \href{https://pq-crystals.org/dilithium/data/dilithium-specification-round3-20210208.pdf}{\texttt{ Algorithm}} Specification. 
\end{DoxyRemark}


\doxysubsection{Function Documentation}
\Hypertarget{dilithium_8h_ad10e76933ac05bda319ad04dc13f150b}\index{dilithium.h@{dilithium.h}!qsc\_dilithium\_generate\_keypair@{qsc\_dilithium\_generate\_keypair}}
\index{qsc\_dilithium\_generate\_keypair@{qsc\_dilithium\_generate\_keypair}!dilithium.h@{dilithium.h}}
\doxysubsubsection{\texorpdfstring{qsc\_dilithium\_generate\_keypair()}{qsc\_dilithium\_generate\_keypair()}}
{\footnotesize\ttfamily \label{dilithium_8h_ad10e76933ac05bda319ad04dc13f150b} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+dilithium\+\_\+generate\+\_\+keypair (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Generates a Dilithium public/private key-\/pair. 

\begin{DoxyWarning}{Warning}
Arrays must be sized to QSC\+\_\+\+DILITHIUM\+\_\+\+PUBLICKEY\+\_\+\+SIZE and QSC\+\_\+\+DILITHIUM\+\_\+\+SECRETKEY\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em publickey} & Pointer to the public verification-\/key array \\
\hline
{\em privatekey} & Pointer to the private signature-\/key array \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{dilithium_8h_acf2512952ca0d01682821d5ccdfb9a24}\index{dilithium.h@{dilithium.h}!qsc\_dilithium\_sign@{qsc\_dilithium\_sign}}
\index{qsc\_dilithium\_sign@{qsc\_dilithium\_sign}!dilithium.h@{dilithium.h}}
\doxysubsubsection{\texorpdfstring{qsc\_dilithium\_sign()}{qsc\_dilithium\_sign()}}
{\footnotesize\ttfamily \label{dilithium_8h_acf2512952ca0d01682821d5ccdfb9a24} 
QSC\+\_\+\+EXPORT\+\_\+\+API void qsc\+\_\+dilithium\+\_\+sign (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{privatekey}{, }\item[{bool(\texorpdfstring{$\ast$}{*}}]{rng\+\_\+generate~}{)(uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t)}\end{DoxyParamCaption})}



Takes the message as input and returns an array containing the signature followed by the message. 

\begin{DoxyWarning}{Warning}
Signature array must be sized to the size of the message plus QSC\+\_\+\+DILITHIUM\+\_\+\+SIGNATURE\+\_\+\+SIZE.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em signedmsg} & Pointer to the signed-\/message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em message} & \mbox{[}const\mbox{]} Pointer to the message array \\
\hline
{\em msglen} & The message array length \\
\hline
{\em privatekey} & \mbox{[}const\mbox{]} Pointer to the private signature-\/key \\
\hline
{\em rng\+\_\+generate} & Pointer to the random generator \\
\hline
\end{DoxyParams}
\Hypertarget{dilithium_8h_a21aa65b5873462ff3ae1d91fcc149c2d}\index{dilithium.h@{dilithium.h}!qsc\_dilithium\_verify@{qsc\_dilithium\_verify}}
\index{qsc\_dilithium\_verify@{qsc\_dilithium\_verify}!dilithium.h@{dilithium.h}}
\doxysubsubsection{\texorpdfstring{qsc\_dilithium\_verify()}{qsc\_dilithium\_verify()}}
{\footnotesize\ttfamily \label{dilithium_8h_a21aa65b5873462ff3ae1d91fcc149c2d} 
QSC\+\_\+\+EXPORT\+\_\+\+API bool qsc\+\_\+dilithium\+\_\+verify (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{msglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signedmsg}{, }\item[{size\+\_\+t}]{smsglen}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{publickey}{}\end{DoxyParamCaption})}



Verifies a signature-\/message pair with the public key. 


\begin{DoxyParams}{Parameters}
{\em message} & Pointer to the message output array \\
\hline
{\em msglen} & Length of the message array \\
\hline
{\em signedmsg} & \mbox{[}const\mbox{]} Pointer to the signed message array \\
\hline
{\em smsglen} & The signed message length \\
\hline
{\em publickey} & \mbox{[}const\mbox{]} Pointer to the public verification-\/key array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true for success 
\end{DoxyReturn}
