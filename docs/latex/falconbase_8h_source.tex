\doxysection{falconbase.\+h}
\hypertarget{falconbase_8h_source}{}\label{falconbase_8h_source}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/falconbase.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/falconbase.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ 2025\ Quantum\ Resistant\ Cryptographic\ Solutions\ Corporation}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ All\ Rights\ Reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ NOTICE:\ This\ software\ and\ all\ accompanying\ materials\ are\ the\ exclusive\ }}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ property\ of\ Quantum\ Resistant\ Cryptographic\ Solutions\ Corporation\ (QRCS).}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ The\ intellectual\ and\ technical\ concepts\ contained\ within\ this\ implementation\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ are\ proprietary\ to\ QRCS\ and\ its\ authorized\ licensors\ and\ are\ protected\ under\ }}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ applicable\ U.S.\ and\ international\ copyright,\ patent,\ and\ trade\ secret\ laws.}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ CRYPTOGRAPHIC\ STANDARDS:}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ -\/\ This\ software\ includes\ implementations\ of\ cryptographic\ algorithms\ such\ as\ }}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ \ \ SHA3,\ AES,\ and\ others.\ These\ algorithms\ are\ public\ domain\ or\ standardized\ }}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ \ \ by\ organizations\ such\ as\ NIST\ and\ are\ NOT\ the\ property\ of\ QRCS.}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ -\/\ However,\ all\ source\ code,\ optimizations,\ and\ implementations\ in\ this\ library\ }}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ \ \ are\ original\ works\ of\ QRCS\ and\ are\ protected\ under\ this\ license.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ RESTRICTIONS:}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ -\/\ Redistribution,\ modification,\ or\ unauthorized\ distribution\ of\ this\ software,\ }}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ \ \ in\ whole\ or\ in\ part,\ is\ strictly\ prohibited.}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ -\/\ This\ software\ is\ provided\ for\ non-\/commercial,\ educational,\ and\ research\ }}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ \ \ purposes\ only.\ Commercial\ use\ in\ any\ form\ is\ expressly\ forbidden.}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ -\/\ Licensing\ and\ authorized\ distribution\ are\ solely\ at\ the\ discretion\ of\ QRCS.}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ -\/\ Any\ use\ of\ this\ software\ implies\ acceptance\ of\ these\ restrictions.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ DISCLAIMER:}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ *\ This\ software\ is\ provided\ "{}as\ is,"{}\ without\ warranty\ of\ any\ kind,\ express\ or\ }}
\DoxyCodeLine{00027\ \textcolor{comment}{\ *\ implied,\ including\ but\ not\ limited\ to\ warranties\ of\ merchantability\ or\ fitness\ }}
\DoxyCodeLine{00028\ \textcolor{comment}{\ *\ for\ a\ particular\ purpose.\ QRCS\ disclaims\ all\ liability\ for\ any\ direct,\ indirect,\ }}
\DoxyCodeLine{00029\ \textcolor{comment}{\ *\ incidental,\ or\ consequential\ damages\ resulting\ from\ the\ use\ or\ misuse\ of\ this\ software.}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ *\ FULL\ LICENSE:}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ *\ This\ software\ is\ subject\ to\ the\ **Quantum\ Resistant\ Cryptographic\ Solutions\ }}
\DoxyCodeLine{00033\ \textcolor{comment}{\ *\ Proprietary\ License\ (QRCS-\/PL)**.\ The\ complete\ license\ terms\ are\ included\ }}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ in\ the\ LICENSE.txt\ file\ distributed\ with\ this\ software.}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ *\ Written\ by:\ John\ G.\ Underhill}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ *\ Contact:\ john.underhill@protonmail.com}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#ifndef\ QSC\_FALCONBASE\_H}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ QSC\_FALCONBASE\_H}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8h}{common.h}}"{}}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{comment}{/*\ \(\backslash\)cond\ DOXYGEN\_IGNORE\ */}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{comment}{/*\ api.h\ */}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#if\ defined(QSC\_FALCON\_S3SHAKE256F512)}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_SECRETKEYBYTES\ 1281}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_PUBLICKEY\_BYTES\ 897}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_SIGNATURE\_BYTES\ 690}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#elif\ defined(QSC\_FALCON\_S5SHAKE256F1024)}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_SECRETKEYBYTES\ 2305}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_PUBLICKEY\_BYTES\ 1793}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#\ \ \ define\ FALCON\_CRYPTO\_SIGNATURE\_BYTES\ 1330}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{comment}{/*\ fpr.h\ */}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#define\ FALCON\_FPR\_GM\_TAB\_SIZE\ 2048}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ FALCON\_FPR\_INV\_SIGMA\_SIZE\ 11}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#define\ FALCON\_FPR\_GM\_P2\_SIZE\ 11}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ FALCON\_Q\ 12289}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#define\ FALCON\_Q0I\ 12287}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#define\ FALCON\_R\ 4091}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#define\ FALCON\_R2\ 10952}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#define\ FALCON\_GMB\_SIZE\ 1024}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_1\ 136}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_2\ 272}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_3\ 224}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_4\ 448}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_5\ 896}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_6\ 1792}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_7\ 3584}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_8\ 7168}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_9\ 14336}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#define\ FALCON\_KEYGEN\_TEMP\_10\ 28672}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#define\ FALCON\_SMALL\_PRIME\_SIZE\ 522}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#define\ FALCON\_GAUS\_1024\_12289\_SIZE\ 27}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#define\ FALCON\_MAX\_BL\_SMALL\_SIZE\ 11}}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#define\ FALCON\_MAX\_BL\_LARGE\_SIZE\ 10}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#define\ FALCON\_DEPTH\_INT\_FG\ 4}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#define\ FALCON\_NONCE\_SIZE\ 40}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#define\ FALCON\_L2BOUND\_SIZE\ 11}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#define\ FALCON\_MAXBITS\_SIZE\ 11}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#define\ FALCON\_REV10\_SIZE\ 1024}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{comment}{/*\ prng.c\ */}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00093\ \{}
\DoxyCodeLine{00094\ \ \ \ \ QSC\_ALIGN(8)\ uint8\_t\ buf[512];}
\DoxyCodeLine{00095\ \ \ \ \ QSC\_ALIGN(8)\ uint8\_t\ state[256];}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ptr;}
\DoxyCodeLine{00097\ \ \ \ \ int32\_t\ type;}
\DoxyCodeLine{00098\ \}\ falcon\_prng\_state;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{comment}{/*\ fpr.c\ */}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ typedef\ uint64\_t\ falcon\_fpr;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ static\ const\ falcon\_fpr\ falcon\_fpr\_q\ =\ 4667981563525332992;}
\DoxyCodeLine{00105\ static\ const\ falcon\_fpr\ falcon\_fpr\_inverse\_of\_q\ =\ 4545632735260551042;}
\DoxyCodeLine{00106\ static\ const\ falcon\_fpr\ falcon\_fpr\_inv\_2sqrsigma0\ =\ 4594603506513722306;}
\DoxyCodeLine{00107\ static\ const\ falcon\_fpr\ falcon\_fpr\_log2\ =\ 4604418534313441775;}
\DoxyCodeLine{00108\ static\ const\ falcon\_fpr\ falcon\_fpr\_inv\_log2\ =\ 4609176140021203710;}
\DoxyCodeLine{00109\ static\ const\ falcon\_fpr\ falcon\_fpr\_bnorm\_max\ =\ 4670353323383631276;}
\DoxyCodeLine{00110\ static\ const\ falcon\_fpr\ falcon\_fpr\_zero\ =\ 0;}
\DoxyCodeLine{00111\ static\ const\ falcon\_fpr\ falcon\_fpr\_one\ =\ 4607182418800017408;}
\DoxyCodeLine{00112\ static\ const\ falcon\_fpr\ falcon\_fpr\_two\ =\ 4611686018427387904;}
\DoxyCodeLine{00113\ static\ const\ falcon\_fpr\ falcon\_fpr\_onehalf\ =\ 4602678819172646912;}
\DoxyCodeLine{00114\ static\ const\ falcon\_fpr\ falcon\_fpr\_invsqrt2\ =\ 4604544271217802189;}
\DoxyCodeLine{00115\ static\ const\ falcon\_fpr\ falcon\_fpr\_invsqrt8\ =\ 4600040671590431693;}
\DoxyCodeLine{00116\ static\ const\ falcon\_fpr\ falcon\_fpr\_ptwo31\ =\ 4746794007248502784;}
\DoxyCodeLine{00117\ static\ const\ falcon\_fpr\ falcon\_fpr\_ptwo31m1\ =\ 4746794007244308480;}
\DoxyCodeLine{00118\ static\ const\ falcon\_fpr\ falcon\_fpr\_mtwo31m1\ =\ 13970166044099084288U;}
\DoxyCodeLine{00119\ static\ const\ falcon\_fpr\ falcon\_fpr\_ptwo63m1\ =\ 4890909195324358656;}
\DoxyCodeLine{00120\ static\ const\ falcon\_fpr\ falcon\_fpr\_mtwo63m1\ =\ 14114281232179134464U;}
\DoxyCodeLine{00121\ static\ const\ falcon\_fpr\ falcon\_fpr\_ptwo63\ =\ 4890909195324358656;}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ typedef\ struct}
\DoxyCodeLine{00124\ \{}
\DoxyCodeLine{00125\ \ \ \ \ uint32\_t\ p;}
\DoxyCodeLine{00126\ \ \ \ \ uint32\_t\ g;}
\DoxyCodeLine{00127\ \ \ \ \ uint32\_t\ s;}
\DoxyCodeLine{00128\ \}\ falcon\_small\_prime;}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ falcon\_fpr\ falcon\_fpr\_inv\_sigma[FALCON\_FPR\_INV\_SIGMA\_SIZE];}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ falcon\_fpr\ falcon\_fpr\_sigma\_min[FALCON\_FPR\_INV\_SIGMA\_SIZE];}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ falcon\_fpr\ falcon\_fpr\_gm\_tab[FALCON\_FPR\_GM\_TAB\_SIZE];}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ falcon\_fpr\ falcon\_fpr\_p2\_tab[FALCON\_FPR\_GM\_P2\_SIZE];}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{comment}{/*\ codec.c\ */}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint8\_t\ falcon\_max\_fg\_bits[FALCON\_MAXBITS\_SIZE];}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint8\_t\ falcon\_max\_FG\_bits[FALCON\_MAXBITS\_SIZE];}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \textcolor{comment}{/*\ verify.c\ */}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint16\_t\ falcon\_GMb[FALCON\_GMB\_SIZE];}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint16\_t\ falcon\_iGMb[FALCON\_GMB\_SIZE];}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ falcon\_small\_prime\ falcon\_small\_primes[FALCON\_SMALL\_PRIME\_SIZE];}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \textcolor{comment}{/*\ keygen.c\ */}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{comment}{/*}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ *\ Table\ below\ incarnates\ a\ discrete\ Gaussian\ distribution:}}
\DoxyCodeLine{00156\ \textcolor{comment}{\ *\ \ \ \ D(x)\ =\ exp(-\/(x\string^2)/(2*sigma\string^2))}}
\DoxyCodeLine{00157\ \textcolor{comment}{\ *\ where\ sigma\ =\ 1.17*sqrt(q/(2*N)),\ q\ =\ 12289,\ and\ N\ =\ 1024.}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ *\ Element\ 0\ of\ the\ table\ is\ P(x\ =\ 0).}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ *\ For\ k\ >\ 0,\ element\ k\ is\ P(x\ >=\ k+1\ |\ x\ >\ 0).}}
\DoxyCodeLine{00160\ \textcolor{comment}{\ *\ Probabilities\ are\ scaled\ up\ by\ 2\string^63.}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00162\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint64\_t\ falcon\_gauss\_1024\_12289[FALCON\_GAUS\_1024\_12289\_SIZE];}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint16\_t\ falcon\_rev10[FALCON\_REV10\_SIZE];}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{comment}{/*}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ *\ The\ falcon\_max\_bl\_small[]\ and\ falcon\_max\_bl\_large[]\ contain\ the\ lengths,\ in\ 31-\/bit}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ *\ words,\ of\ intermediate\ values\ in\ the\ computation:}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ *\ \ \ falcon\_max\_bl\_small[depth]:\ length\ for\ the\ input\ f\ and\ g\ at\ that\ depth}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ *\ \ \ falcon\_max\_bl\_large[depth]:\ length\ for\ the\ unreduced\ F\ and\ G\ at\ that\ depth}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ *\ Rules:}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ *\ \ -\/\ Within\ an\ array,\ values\ grow.}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ *\ \ -\/\ The\ 'SMALL'\ array\ must\ have\ an\ entry\ for\ maximum\ depth,\ corresponding}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ *\ \ \ \ to\ the\ size\ of\ values\ used\ in\ the\ binary\ GCD.\ There\ is\ no\ such\ value}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ *\ \ \ \ for\ the\ 'LARGE'\ array\ (the\ binary\ GCD\ yields\ already\ reduced}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ *\ \ \ \ coefficients).}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ *\ \ -\/\ falcon\_max\_bl\_large[depth]\ >=\ falcon\_max\_bl\_small[depth\ +\ 1].}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00184\ \textcolor{comment}{\ *\ \ -\/\ Values\ must\ be\ large\ enough\ to\ handle\ the\ common\ cases,\ with\ some}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ *\ \ \ \ margins.}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ *\ \ -\/\ Values\ must\ not\ be\ "{}too\ large"{}\ either\ because\ we\ will\ convert\ some}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ *\ \ \ \ integers\ into\ floating-\/point\ values\ by\ considering\ the\ top\ 10\ words,}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ *\ \ \ \ i.e.\ 310\ bits;\ hence,\ for\ values\ of\ length\ more\ than\ 10\ words,\ we}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ *\ \ \ \ should\ take\ care\ to\ have\ the\ length\ centered\ on\ the\ expected\ size.}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00192\ \textcolor{comment}{\ *\ The\ following\ average\ lengths,\ in\ bits,\ have\ been\ measured\ on\ thousands}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ *\ of\ random\ keys\ (fg\ =\ max\ length\ of\ the\ absolute\ value\ of\ coefficients}}
\DoxyCodeLine{00194\ \textcolor{comment}{\ *\ of\ f\ and\ g\ at\ that\ depth;\ FG\ =\ idem\ for\ the\ unreduced\ F\ and\ G;\ for\ the}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ *\ maximum\ depth,\ F\ and\ G\ are\ the\ output\ of\ binary\ GCD,\ multiplied\ by\ q;}}
\DoxyCodeLine{00196\ \textcolor{comment}{\ *\ for\ each\ value,\ the\ average\ and\ standard\ deviation\ are\ provided).}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00198\ \textcolor{comment}{\ *\ Binary\ case:}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ *\ \ \ \ depth:\ 10\ \ \ \ fg:\ 6307.52\ (24.48)\ \ \ \ FG:\ 6319.66\ (24.51)}}
\DoxyCodeLine{00200\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 9\ \ \ \ fg:\ 3138.35\ (12.25)\ \ \ \ FG:\ 9403.29\ (27.55)}}
\DoxyCodeLine{00201\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 8\ \ \ \ fg:\ 1576.87\ (\ 7.49)\ \ \ \ FG:\ 4703.30\ (14.77)}}
\DoxyCodeLine{00202\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 7\ \ \ \ fg:\ \ 794.17\ (\ 4.98)\ \ \ \ FG:\ 2361.84\ (\ 9.31)}}
\DoxyCodeLine{00203\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 6\ \ \ \ fg:\ \ 400.67\ (\ 3.10)\ \ \ \ FG:\ 1188.68\ (\ 6.04)}}
\DoxyCodeLine{00204\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 5\ \ \ \ fg:\ \ 202.22\ (\ 1.87)\ \ \ \ FG:\ \ 599.81\ (\ 3.87)}}
\DoxyCodeLine{00205\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 4\ \ \ \ fg:\ \ 101.62\ (\ 1.02)\ \ \ \ FG:\ \ 303.49\ (\ 2.38)}}
\DoxyCodeLine{00206\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 3\ \ \ \ fg:\ \ \ 50.37\ (\ 0.53)\ \ \ \ FG:\ \ 153.65\ (\ 1.39)}}
\DoxyCodeLine{00207\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 2\ \ \ \ fg:\ \ \ 24.07\ (\ 0.25)\ \ \ \ FG:\ \ \ 78.20\ (\ 0.73)}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 1\ \ \ \ fg:\ \ \ 10.99\ (\ 0.08)\ \ \ \ FG:\ \ \ 39.82\ (\ 0.41)}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ *\ \ \ \ depth:\ \ 0\ \ \ \ fg:\ \ \ \ 4.00\ (\ 0.00)\ \ \ \ FG:\ \ \ 19.61\ (\ 0.49)}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ *\ Integers\ are\ actually\ represented\ either\ in\ binary\ notation\ over}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ *\ 31-\/bit\ words\ (signed,\ using\ two's\ complement),\ or\ in\ RNS,\ modulo}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ *\ many\ small\ primes.\ These\ small\ primes\ are\ close\ to,\ but\ slightly}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ *\ lower\ than,\ 2\string^31.\ Use\ of\ RNS\ loses\ less\ than\ two\ bits,\ even\ for}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ *\ the\ largest\ values.}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ *\ IMPORTANT:\ if\ these\ values\ are\ modified,\ then\ the\ temporary\ buffer}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ *\ sizes\ (FALCON\_KEYGEN\_TEMP\_*,\ in\ inner.h)\ must\ be\ recomputed}}
\DoxyCodeLine{00219\ \textcolor{comment}{\ *\ accordingly.}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00221\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ falcon\_max\_bl\_small[FALCON\_MAX\_BL\_SMALL\_SIZE];}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ falcon\_max\_bl\_large[FALCON\_MAX\_BL\_LARGE\_SIZE];}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \textcolor{comment}{/*}}
\DoxyCodeLine{00226\ \textcolor{comment}{\ *\ Average\ and\ standard\ deviation\ for\ the\ maximum\ size\ (in\ bits)\ of}}
\DoxyCodeLine{00227\ \textcolor{comment}{\ *\ coefficients\ of\ (f,g),\ depending\ on\ depth.\ These\ values\ are\ used}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ *\ to\ compute\ bounds\ for\ Babai's\ reduction.}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00230\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00231\ \{}
\DoxyCodeLine{00232\ \ \ \ \ int32\_t\ avg;}
\DoxyCodeLine{00233\ \ \ \ \ int32\_t\ std;}
\DoxyCodeLine{00234\ \}\ falcon\_bit\_length[]\ =}
\DoxyCodeLine{00235\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \{\ \ \ \ 4,\ \ 0\ \},}
\DoxyCodeLine{00237\ \ \ \ \ \{\ \ \ 11,\ \ 1\ \},}
\DoxyCodeLine{00238\ \ \ \ \ \{\ \ \ 24,\ \ 1\ \},}
\DoxyCodeLine{00239\ \ \ \ \ \{\ \ \ 50,\ \ 1\ \},}
\DoxyCodeLine{00240\ \ \ \ \ \{\ \ 102,\ \ 1\ \},}
\DoxyCodeLine{00241\ \ \ \ \ \{\ \ 202,\ \ 2\ \},}
\DoxyCodeLine{00242\ \ \ \ \ \{\ \ 401,\ \ 4\ \},}
\DoxyCodeLine{00243\ \ \ \ \ \{\ \ 794,\ \ 5\ \},}
\DoxyCodeLine{00244\ \ \ \ \ \{\ 1577,\ \ 8\ \},}
\DoxyCodeLine{00245\ \ \ \ \ \{\ 3138,\ 13\ \},}
\DoxyCodeLine{00246\ \ \ \ \ \{\ 6308,\ 25\ \}}
\DoxyCodeLine{00247\ \};}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \textcolor{comment}{/*\ sign.c\ */}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00252\ \{}
\DoxyCodeLine{00253\ \ \ \ \ falcon\_prng\_state\ p;}
\DoxyCodeLine{00254\ \ \ \ \ falcon\_fpr\ sigma\_min;}
\DoxyCodeLine{00255\ \}\ falcon\_sampler\_context;}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{keyword}{typedef}\ int32\_t(*falcon\_samplerZ)(\textcolor{keywordtype}{void}*\ ctx,\ falcon\_fpr\ mu,\ falcon\_fpr\ sigma);}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \textcolor{comment}{/*\ common.c\ */}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint32\_t\ falcon\_l2bound[FALCON\_L2BOUND\_SIZE];}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \textcolor{comment}{/*\ public\ functions\ */}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00273\ int32\_t\ qsc\_falcon\_ref\_generate\_keypair(uint8\_t\ *pk,\ uint8\_t\ *sk,\ \textcolor{keywordtype}{bool}\ (*rng\_generate)(uint8\_t*,\ \textcolor{keywordtype}{size\_t}));}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00285\ int32\_t\ qsc\_falcon\_ref\_sign(uint8\_t\ *sm,\ \textcolor{keywordtype}{size\_t}\ *smlen,\ \textcolor{keyword}{const}\ uint8\_t\ *m,\ \textcolor{keywordtype}{size\_t}\ mlen,\ \textcolor{keyword}{const}\ uint8\_t\ *sk,\ \textcolor{keywordtype}{bool}\ (*rng\_generate)(uint8\_t*,\ \textcolor{keywordtype}{size\_t}));}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00297\ \textcolor{keywordtype}{bool}\ qsc\_falcon\_ref\_open(uint8\_t\ *m,\ \textcolor{keywordtype}{size\_t}\ *mlen,\ \textcolor{keyword}{const}\ uint8\_t\ *sm,\ \textcolor{keywordtype}{size\_t}\ smlen,\ \textcolor{keyword}{const}\ uint8\_t\ *pk);}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \textcolor{comment}{/*\ \(\backslash\)endcond\ DOXYGEN\_IGNORE\ */}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
