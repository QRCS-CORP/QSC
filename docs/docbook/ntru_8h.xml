<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_ntru_8h" xml:lang="en-US">
<title>C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/ntru.h File Reference</title>
<indexterm><primary>C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/ntru.h</primary></indexterm>
<para>

<para>Contains the public api for the NTRU CCA-secure Key Encapsulation Mechanism implementation. </para>
 
</para>
<programlisting linenumbering="unnumbered">#include &quot;common.h&quot;<?linebreak?>#include &quot;ntrubase.h&quot;<?linebreak?></programlisting><simplesect>
    <title>Macros    </title>
        <itemizedlist>
            <listitem><para><anchor xml:id="_ntru_8h_1a6517986d39668036ce5b25c50b8673ef"/>#define <emphasis role="strong">QSC_NTRU_SEED_SIZE</emphasis>&#160;&#160;&#160;32</para>

<para>The byte size of the seed array. </para>
</listitem>
            <listitem><para><anchor xml:id="_ntru_8h_1a7e965b3b7bd6a8e97030d4770b540af2"/>#define <emphasis role="strong">QSC_NTRU_SHAREDSECRET_SIZE</emphasis>&#160;&#160;&#160;32</para>

<para>The byte size of the shared secret-key array. </para>
</listitem>
            <listitem><para><anchor xml:id="_ntru_8h_1ac2479301d3e37d96591896c4d5ab62b7"/>#define <emphasis role="strong">QSC_NTRU_ALGNAME</emphasis>&#160;&#160;&#160;&quot;NTRU&quot;</para>

<para>The formal algorithm name. </para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para>QSC_EXPORT_API bool <link linkend="_ntru_8h_1aff2ebda121b1e2f575ec7a70b043d9f8">qsc_ntru_decapsulate</link> (uint8_t *secret, const uint8_t *ciphertext, const uint8_t *privatekey)</para>

<para>Decapsulates the shared secret for a given cipher-text using a private-key. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API bool <link linkend="_ntru_8h_1a1e0bf3b594bdc45b053f4919e0091106">qsc_ntru_decrypt</link> (uint8_t *secret, const uint8_t *ciphertext, const uint8_t *privatekey)</para>

<para>Decrypts the shared secret for a given cipher-text using a private-key Used in conjunction with the encrypt function. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API void <link linkend="_ntru_8h_1a05b4ef7106f91993163a11351c0f44fe">qsc_ntru_encapsulate</link> (uint8_t *secret, uint8_t *ciphertext, const uint8_t *publickey, bool(*rng_generate)(uint8_t *, size_t))</para>

<para>Generates cipher-text and encapsulates a shared secret key using a public-key. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API void <link linkend="_ntru_8h_1a25236608a29ac5a094031269a0b61051">qsc_ntru_encrypt</link> (uint8_t *secret, uint8_t *ciphertext, const uint8_t *publickey, const uint8_t seed[<link linkend="_ntru_8h_1a6517986d39668036ce5b25c50b8673ef">QSC_NTRU_SEED_SIZE</link>])</para>

<para>Generates cipher-text and encapsulates a shared secret key using a public-key Used in conjunction with the encrypt function. </para>
</listitem>
            <listitem><para>QSC_EXPORT_API void <link linkend="_ntru_8h_1af72adbf9fd319cefb87d3b556a9d81d9">qsc_ntru_generate_keypair</link> (uint8_t *publickey, uint8_t *privatekey, bool(*rng_generate)(uint8_t *, size_t))</para>

<para>Generates public and private key for the NTRU key encapsulation mechanism. </para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Detailed Description</title>

<para>Contains the public api for the NTRU CCA-secure Key Encapsulation Mechanism implementation. </para>

<para><formalpara>
<title>Example</title>
<para><literallayout><computeroutput>uint8_t&#32;ct[QSC_NTRU_CIPHERTEXT_SIZE];
uint8_t&#32;pk[QSC_NTRU_PUBLICKEY_SIZE];
uint8_t&#32;sk[QSC_NTRU_PRIVATEKEY_SIZE];
uint8_t&#32;ssa[<link linkend="_ntru_8h_1a7e965b3b7bd6a8e97030d4770b540af2">QSC_NTRU_SHAREDSECRET_SIZE</link>];
uint8_t&#32;ssb[<link linkend="_ntru_8h_1a7e965b3b7bd6a8e97030d4770b540af2">QSC_NTRU_SHAREDSECRET_SIZE</link>];

qsc_ntru_generate_keypair(pk,&#32;sk);
qsc_ntru_encapsulate(ssb,&#32;ct,&#32;pk);

<emphasis role="keywordflow">if</emphasis>&#32;(qsc_ntru_decapsulate(ssa,&#32;ct,&#32;sk)&#32;==&#32;<emphasis role="keyword">false</emphasis>)
{
&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;decapsulation&#32;failed,&#32;do&#32;something..</emphasis>
}
</computeroutput></literallayout></para>
</formalpara>
<formalpara><title>Remarks</title>

<para>Based on the C reference branch of NIST PQC Round 3 submission; including base code, comments, and api. <?linebreak?>The NIST Post Quantum Competition <link xlink:href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions">Round 3</link> Finalists. <?linebreak?>NIST PQC Round 3: <link xlink:href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions">NTRU</link>. <?linebreak?>The NTRU <link xlink:href="https://ntru.org/f/ntru-20190330.pdf">Algorithm.</link> Specifications. <?linebreak?></para>
</formalpara>
</para>
</section>
<section>
<title>Function Documentation</title>
<anchor xml:id="_ntru_8h_1aff2ebda121b1e2f575ec7a70b043d9f8"/><section>
    <title>qsc_ntru_decapsulate()</title>
<indexterm><primary>qsc_ntru_decapsulate</primary><secondary>ntru.h</secondary></indexterm>
<indexterm><primary>ntru.h</primary><secondary>qsc_ntru_decapsulate</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API bool qsc_ntru_decapsulate (uint8_t * secret, const uint8_t * ciphertext, const uint8_t * privatekey)</computeroutput></para><para>

<para>Decapsulates the shared secret for a given cipher-text using a private-key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>secret</entry><entry>
<para>Pointer to the output shared secret key, an array of QSC_NTRU_SHAREDSECRET_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>ciphertext</entry><entry>
<para>[const] Pointer to the cipher-text array of QSC_NTRU_CIPHERTEXT_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>privatekey</entry><entry>
<para>[const] Pointer to the secret-key array of QSC_NTRU_PRIVATEKEY_SIZE constant size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Returns true for success </para>
</formalpara>
</para>
</section>
<anchor xml:id="_ntru_8h_1a1e0bf3b594bdc45b053f4919e0091106"/><section>
    <title>qsc_ntru_decrypt()</title>
<indexterm><primary>qsc_ntru_decrypt</primary><secondary>ntru.h</secondary></indexterm>
<indexterm><primary>ntru.h</primary><secondary>qsc_ntru_decrypt</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API bool qsc_ntru_decrypt (uint8_t * secret, const uint8_t * ciphertext, const uint8_t * privatekey)</computeroutput></para><para>

<para>Decrypts the shared secret for a given cipher-text using a private-key Used in conjunction with the encrypt function. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>secret</entry><entry>
<para>Pointer to the output shared secret key, an array of QSC_KYBER_SHAREDSECRET_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>ciphertext</entry><entry>
<para>[const] Pointer to the cipher-text array of QSC_KYBER_CIPHERTEXT_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>privatekey</entry><entry>
<para>[const] Pointer to the secret-key array of QSC_KYBER_PRIVATEKEY_SIZE constant size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Returns true for success </para>
</formalpara>
</para>
</section>
<anchor xml:id="_ntru_8h_1a05b4ef7106f91993163a11351c0f44fe"/><section>
    <title>qsc_ntru_encapsulate()</title>
<indexterm><primary>qsc_ntru_encapsulate</primary><secondary>ntru.h</secondary></indexterm>
<indexterm><primary>ntru.h</primary><secondary>qsc_ntru_encapsulate</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API void qsc_ntru_encapsulate (uint8_t * secret, uint8_t * ciphertext, const uint8_t * publickey, bool(* rng_generate&#160;)(uint8_t *, size_t))</computeroutput></para><para>

<para>Generates cipher-text and encapsulates a shared secret key using a public-key. </para>
</para>

<para><warning><title>Warning</title>

<para>Cipher-text array must be sized to the QSC_NTRU_CIPHERTEXT_SIZE.</para>
</warning>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>secret</entry><entry>
<para>Pointer to the shared secret key, a uint8_t array of QSC_NTRU_SHAREDSECRET_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>ciphertext</entry><entry>
<para>Pointer to the cipher-text array of QSC_NTRU_CIPHERTEXT_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>publickey</entry><entry>
<para>[const] Pointer to the public-key array of QSC_NTRU_PUBLICKEY_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>rng_generate</entry><entry>
<para>A pointer to the random generator function </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_ntru_8h_1a25236608a29ac5a094031269a0b61051"/><section>
    <title>qsc_ntru_encrypt()</title>
<indexterm><primary>qsc_ntru_encrypt</primary><secondary>ntru.h</secondary></indexterm>
<indexterm><primary>ntru.h</primary><secondary>qsc_ntru_encrypt</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API void qsc_ntru_encrypt (uint8_t * secret, uint8_t * ciphertext, const uint8_t * publickey, const uint8_t seed[QSC_NTRU_SEED_SIZE])</computeroutput></para><para>

<para>Generates cipher-text and encapsulates a shared secret key using a public-key Used in conjunction with the encrypt function. </para>
</para>

<para><warning><title>Warning</title>

<para>Cipher-text array must be sized to the QSC_KYBER_CIPHERTEXT_SIZE.</para>
</warning>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>secret</entry><entry>
<para>Pointer to the shared secret key, a uint8_t array of QSC_KYBER_SHAREDSECRET_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>ciphertext</entry><entry>
<para>Pointer to the cipher-text array of QSC_KYBER_CIPHERTEXT_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>publickey</entry><entry>
<para>[const] Pointer to the public-key array of QSC_KYBER_PUBLICKEY_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>seed</entry><entry>
<para>[const] A pointer to the random seed array </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_ntru_8h_1af72adbf9fd319cefb87d3b556a9d81d9"/><section>
    <title>qsc_ntru_generate_keypair()</title>
<indexterm><primary>qsc_ntru_generate_keypair</primary><secondary>ntru.h</secondary></indexterm>
<indexterm><primary>ntru.h</primary><secondary>qsc_ntru_generate_keypair</secondary></indexterm>
<para><computeroutput>QSC_EXPORT_API void qsc_ntru_generate_keypair (uint8_t * publickey, uint8_t * privatekey, bool(* rng_generate&#160;)(uint8_t *, size_t))</computeroutput></para><para>

<para>Generates public and private key for the NTRU key encapsulation mechanism. </para>
</para>

<para><warning><title>Warning</title>

<para>Arrays must be sized to QSC_NTRU_PUBLICKEY_SIZE and QSC_NTRU_SECRETKEY_SIZE.</para>
</warning>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>publickey</entry><entry>
<para>Pointer to the output public-key array of QSC_NTRU_PUBLICKEY_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>privatekey</entry><entry>
<para>Pointer to output private-key array of QSC_NTRU_PRIVATEKEY_SIZE constant size </para>
</entry>
                            </row>
                            <row>
<entry>rng_generate</entry><entry>
<para>A pointer to the random generator function </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
</section>
</section>
