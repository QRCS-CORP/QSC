<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_rcs_8h_source" xml:lang="en-US">
<title>rcs.h</title>
<indexterm><primary>C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/rcs.h</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered">1 <emphasis role="comment">/*&#32;2025&#32;Quantum&#32;Resistant&#32;Cryptographic&#32;Solutions&#32;Corporation</emphasis>
2 <emphasis role="comment">&#32;*&#32;All&#32;Rights&#32;Reserved.</emphasis>
3 <emphasis role="comment">&#32;*</emphasis>
4 <emphasis role="comment">&#32;*&#32;NOTICE:&#32;This&#32;software&#32;and&#32;all&#32;accompanying&#32;materials&#32;are&#32;the&#32;exclusive&#32;</emphasis>
5 <emphasis role="comment">&#32;*&#32;property&#32;of&#32;Quantum&#32;Resistant&#32;Cryptographic&#32;Solutions&#32;Corporation&#32;(QRCS).</emphasis>
6 <emphasis role="comment">&#32;*&#32;The&#32;intellectual&#32;and&#32;technical&#32;concepts&#32;contained&#32;within&#32;this&#32;implementation&#32;</emphasis>
7 <emphasis role="comment">&#32;*&#32;are&#32;proprietary&#32;to&#32;QRCS&#32;and&#32;its&#32;authorized&#32;licensors&#32;and&#32;are&#32;protected&#32;under&#32;</emphasis>
8 <emphasis role="comment">&#32;*&#32;applicable&#32;U.S.&#32;and&#32;international&#32;copyright,&#32;patent,&#32;and&#32;trade&#32;secret&#32;laws.</emphasis>
9 <emphasis role="comment">&#32;*</emphasis>
10 <emphasis role="comment">&#32;*&#32;CRYPTOGRAPHIC&#32;STANDARDS:</emphasis>
11 <emphasis role="comment">&#32;*&#32;-&#32;This&#32;software&#32;includes&#32;implementations&#32;of&#32;cryptographic&#32;algorithms&#32;such&#32;as&#32;</emphasis>
12 <emphasis role="comment">&#32;*&#32;&#32;&#32;SHA3,&#32;AES,&#32;and&#32;others.&#32;These&#32;algorithms&#32;are&#32;public&#32;domain&#32;or&#32;standardized&#32;</emphasis>
13 <emphasis role="comment">&#32;*&#32;&#32;&#32;by&#32;organizations&#32;such&#32;as&#32;NIST&#32;and&#32;are&#32;NOT&#32;the&#32;property&#32;of&#32;QRCS.</emphasis>
14 <emphasis role="comment">&#32;*&#32;-&#32;However,&#32;all&#32;source&#32;code,&#32;optimizations,&#32;and&#32;implementations&#32;in&#32;this&#32;library&#32;</emphasis>
15 <emphasis role="comment">&#32;*&#32;&#32;&#32;are&#32;original&#32;works&#32;of&#32;QRCS&#32;and&#32;are&#32;protected&#32;under&#32;this&#32;license.</emphasis>
16 <emphasis role="comment">&#32;*</emphasis>
17 <emphasis role="comment">&#32;*&#32;RESTRICTIONS:</emphasis>
18 <emphasis role="comment">&#32;*&#32;-&#32;Redistribution,&#32;modification,&#32;or&#32;unauthorized&#32;distribution&#32;of&#32;this&#32;software,&#32;</emphasis>
19 <emphasis role="comment">&#32;*&#32;&#32;&#32;in&#32;whole&#32;or&#32;in&#32;part,&#32;is&#32;strictly&#32;prohibited.</emphasis>
20 <emphasis role="comment">&#32;*&#32;-&#32;This&#32;software&#32;is&#32;provided&#32;for&#32;non-commercial,&#32;educational,&#32;and&#32;research&#32;</emphasis>
21 <emphasis role="comment">&#32;*&#32;&#32;&#32;purposes&#32;only.&#32;Commercial&#32;use&#32;in&#32;any&#32;form&#32;is&#32;expressly&#32;forbidden.</emphasis>
22 <emphasis role="comment">&#32;*&#32;-&#32;Licensing&#32;and&#32;authorized&#32;distribution&#32;are&#32;solely&#32;at&#32;the&#32;discretion&#32;of&#32;QRCS.</emphasis>
23 <emphasis role="comment">&#32;*&#32;-&#32;Any&#32;use&#32;of&#32;this&#32;software&#32;implies&#32;acceptance&#32;of&#32;these&#32;restrictions.</emphasis>
24 <emphasis role="comment">&#32;*</emphasis>
25 <emphasis role="comment">&#32;*&#32;DISCLAIMER:</emphasis>
26 <emphasis role="comment">&#32;*&#32;This&#32;software&#32;is&#32;provided&#32;&quot;as&#32;is,&quot;&#32;without&#32;warranty&#32;of&#32;any&#32;kind,&#32;express&#32;or&#32;</emphasis>
27 <emphasis role="comment">&#32;*&#32;implied,&#32;including&#32;but&#32;not&#32;limited&#32;to&#32;warranties&#32;of&#32;merchantability&#32;or&#32;fitness&#32;</emphasis>
28 <emphasis role="comment">&#32;*&#32;for&#32;a&#32;particular&#32;purpose.&#32;QRCS&#32;disclaims&#32;all&#32;liability&#32;for&#32;any&#32;direct,&#32;indirect,&#32;</emphasis>
29 <emphasis role="comment">&#32;*&#32;incidental,&#32;or&#32;consequential&#32;damages&#32;resulting&#32;from&#32;the&#32;use&#32;or&#32;misuse&#32;of&#32;this&#32;software.</emphasis>
30 <emphasis role="comment">&#32;*</emphasis>
31 <emphasis role="comment">&#32;*&#32;FULL&#32;LICENSE:</emphasis>
32 <emphasis role="comment">&#32;*&#32;This&#32;software&#32;is&#32;subject&#32;to&#32;the&#32;**Quantum&#32;Resistant&#32;Cryptographic&#32;Solutions&#32;</emphasis>
33 <emphasis role="comment">&#32;*&#32;Proprietary&#32;License&#32;(QRCS-PL)**.&#32;The&#32;complete&#32;license&#32;terms&#32;are&#32;included&#32;</emphasis>
34 <emphasis role="comment">&#32;*&#32;in&#32;the&#32;LICENSE.txt&#32;file&#32;distributed&#32;with&#32;this&#32;software.</emphasis>
35 <emphasis role="comment">&#32;*</emphasis>
36 <emphasis role="comment">&#32;*&#32;Written&#32;by:&#32;John&#32;G.&#32;Underhill</emphasis>
37 <emphasis role="comment">&#32;*&#32;Contact:&#32;john.underhill@protonmail.com</emphasis>
38 <emphasis role="comment">&#32;*/</emphasis>
39 
40 
41 <emphasis role="preprocessor">#ifndef&#32;QSC_RCS_H</emphasis>
42 <emphasis role="preprocessor">#define&#32;QSC_RCS_H</emphasis>
43 
134 
135 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_common_8h">common.h</link>&quot;</emphasis>
136 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_sha3_8h">sha3.h</link>&quot;</emphasis>
137 <emphasis role="preprocessor">#if&#32;defined(QSC_SYSTEM_AESNI_ENABLED)</emphasis>
138 <emphasis role="preprocessor">#&#32;&#32;&#32;include&#32;&quot;intrinsics.h&quot;</emphasis>
139 <emphasis role="preprocessor">#&#32;&#32;&#32;include&#32;&lt;immintrin.h&gt;</emphasis>
140 <emphasis role="preprocessor">#endif</emphasis>
141 
142 <emphasis role="comment">/***********************************</emphasis>
143 <emphasis role="comment">*&#32;&#32;&#32;&#32;USER&#32;CONFIGURABLE&#32;SETTINGS&#32;&#32;&#32;&#32;*</emphasis>
144 <emphasis role="comment">***********************************/</emphasis>
145 
151 <emphasis role="preprocessor">#if&#32;!defined(QSC_RCS_AUTHENTICATED)</emphasis>
152 <emphasis role="preprocessor">#&#32;&#32;&#32;define&#32;QSC_RCS_AUTHENTICATED</emphasis>
153 <emphasis role="preprocessor">#endif</emphasis>
154 
155 <emphasis role="comment">/*&#32;Enable&#32;one&#32;of&#32;the&#32;authentication&#32;options:&#32;</emphasis>
156 <emphasis role="comment">a&#32;24&#32;round&#32;KMAC,&#32;a&#32;reduced&#32;rounds&#32;KMAC,&#32;or&#32;the&#32;PMAC&#32;post&#32;quantum&#32;GMAC&#32;function&#32;*/</emphasis>
157 <emphasis role="preprocessor">#if&#32;defined(QSC_RCS_AUTHENTICATED)</emphasis>
159 <emphasis role="comment">//*&#32;\def&#32;QSC_RCS_AUTH_KMACR24</emphasis>
160 <emphasis role="comment">//*&#32;\brief&#32;Sets&#32;the&#32;authentication&#32;mode&#32;to&#32;standard&#32;KMAC-R24.</emphasis>
161 <emphasis role="comment">//*&#32;Remove&#32;this&#32;definition&#32;to&#32;enable&#32;the&#32;reduced&#32;rounds&#32;version&#32;using&#32;KMAC-R12.</emphasis>
162 <emphasis role="comment">//*/</emphasis>
163 <emphasis role="comment">//#&#32;define&#32;QSC_RCS_AUTH_KMACR24</emphasis>
164 
166 <emphasis role="comment">//\def&#32;QSC_RCS_KMAC_R12</emphasis>
167 <emphasis role="comment">//*&#32;\brief&#32;Enables&#32;the&#32;reduced&#32;rounds&#32;KMAC-R12&#32;implementation.</emphasis>
168 <emphasis role="comment">//*/</emphasis>
169 <emphasis role="comment">//#&#32;define&#32;QSC_RCS_AUTH_KMACR12</emphasis>
170 
175 <emphasis role="preprocessor">#&#32;&#32;&#32;define&#32;QSC_RCS_AUTH_PMAC</emphasis>
176 <emphasis role="preprocessor">#endif</emphasis>
177 
178 <emphasis role="comment">/*&#32;The&#32;default&#32;authentication&#32;MAC&#32;*/</emphasis>
179 <emphasis role="preprocessor">#if&#32;defined(QSC_RCS_AUTHENTICATED)</emphasis>
180 <emphasis role="preprocessor">#&#32;&#32;&#32;if&#32;!defined(QSC_RCS_AUTH_KMACR24)&#32;&amp;&amp;&#32;!defined(QSC_RCS_AUTH_KMACR12)&#32;&amp;&amp;&#32;!defined(QSC_RCS_AUTH_PMAC)</emphasis>
181 <emphasis role="preprocessor">#&#32;&#32;&#32;&#32;&#32;&#32;&#32;define&#32;QSC_RCS_AUTH_KMACR24</emphasis>
182 <emphasis role="preprocessor">#&#32;&#32;&#32;endif</emphasis>
183 <emphasis role="preprocessor">#endif</emphasis>
184 
185 <emphasis role="preprocessor">#if&#32;defined(QSC_RCS_AUTH_PMAC)</emphasis>
186 <emphasis role="preprocessor">#&#32;&#32;&#32;include&#32;&quot;<link linkend="_pmac_8h">pmac.h</link>&quot;</emphasis>
187 <emphasis role="preprocessor">#endif</emphasis>
188 
189 <emphasis role="comment">/***********************************</emphasis>
190 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;RCS&#32;CONSTANTS&#32;AND&#32;SIZES&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
191 <emphasis role="comment">***********************************/</emphasis>
192 
197 <emphasis role="preprocessor">#define&#32;QSC_RCS_BLOCK_SIZE&#32;32</emphasis>
198 
203 <emphasis role="preprocessor">#define&#32;QSC_RCS256_KEY_SIZE&#32;32</emphasis>
204 
209 <emphasis role="preprocessor">#define&#32;QSC_RCS256_MAC_SIZE&#32;32</emphasis>
210 
215 <emphasis role="preprocessor">#define&#32;QSC_RCS512_KEY_SIZE&#32;64</emphasis>
216 
217 <emphasis role="preprocessor">#if&#32;defined(QSC_RCS_AUTH_PMAC)</emphasis><emphasis role="preprocessor"></emphasis>
222 <emphasis role="preprocessor">#define&#32;QSC_RCS512_MAC_SIZE&#32;32</emphasis>
223 <emphasis role="preprocessor">#else</emphasis><emphasis role="preprocessor"></emphasis>
228 <emphasis role="preprocessor">#define&#32;QSC_RCS512_MAC_SIZE&#32;64</emphasis>
229 <emphasis role="preprocessor">#endif</emphasis>
230 
235 <emphasis role="preprocessor">#define&#32;QSC_RCS_NONCE_SIZE&#32;32</emphasis>
236 
240 <emphasis role="keyword">typedef</emphasis>&#32;<emphasis role="keyword">enum</emphasis>
241 {
242 &#32;&#32;&#32;&#32;<link linkend="_rcs_8h_1a1b672c28ae12a1d8fa576538fa4909c5a8066b8ef46ff1b2aa2c240b0971b1cd2">RCS256</link>&#32;=&#32;1,&#32;
243 &#32;&#32;&#32;&#32;<link linkend="_rcs_8h_1a1b672c28ae12a1d8fa576538fa4909c5a1fc6600960c152f07a407ea92b300070">RCS512</link>&#32;=&#32;2,&#32;
244 }&#32;<link linkend="_rcs_8h_1a1b672c28ae12a1d8fa576538fa4909c5">rcs_cipher_type</link>;
245 
254 QSC_EXPORT_API&#32;<emphasis role="keyword">typedef</emphasis>&#32;<emphasis role="keyword">struct</emphasis>
255 {
256 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint8_t*&#32;<link linkend="_structqsc__rcs__keyparams_1aa60a0c39d29c4a6fdaac5bfc05f1dbec">key</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
257 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;<link linkend="_structqsc__rcs__keyparams_1af347fae5dae0b613448c54f3dea76ad2">keylen</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
258 &#32;&#32;&#32;&#32;uint8_t*&#32;<link linkend="_structqsc__rcs__keyparams_1a3da4e88c03c821f8b2dc28af618543bd">nonce</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
259 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;uint8_t*&#32;<link linkend="_structqsc__rcs__keyparams_1af70030048884ad194b9870321e1cf792">info</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
260 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;<link linkend="_structqsc__rcs__keyparams_1aeeac5f1dea8f8694bdf3d934c72ae872">infolen</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
261 }&#32;<link linkend="_structqsc__rcs__keyparams">qsc_rcs_keyparams</link>;
262 
267 QSC_EXPORT_API&#32;<emphasis role="keyword">typedef</emphasis>&#32;<emphasis role="keyword">struct</emphasis>
268 {
269 &#32;&#32;&#32;&#32;<link linkend="_rcs_8h_1a1b672c28ae12a1d8fa576538fa4909c5">rcs_cipher_type</link>&#32;<link linkend="_structqsc__rcs__state_1a29d11ab8aade9c9b97c058c2a6aa54fc">ctype</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
270 <emphasis role="preprocessor">#if&#32;defined(QSC_SYSTEM_AESNI_ENABLED)</emphasis>
271 &#32;&#32;&#32;&#32;__m128i&#32;<link linkend="_structqsc__rcs__state_1a9232ecb195cf082110caad41c6cc3bf8">roundkeys</link>[62];&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
272 <emphasis role="preprocessor">#&#32;&#32;&#32;if&#32;defined(QSC_SYSTEM_HAS_AVX512)</emphasis>
273 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;__m512i&#32;roundkeysw[31];&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
274 <emphasis role="preprocessor">#&#32;&#32;&#32;endif</emphasis>
275 <emphasis role="preprocessor">#else</emphasis>
276 &#32;&#32;&#32;&#32;uint32_t&#32;<link linkend="_structqsc__rcs__state_1a9232ecb195cf082110caad41c6cc3bf8">roundkeys</link>[248];&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
277 <emphasis role="preprocessor">#endif</emphasis>
278 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;<link linkend="_structqsc__rcs__state_1a44bdbbaee0cf6de6912ae93ee8dc5702">roundkeylen</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
279 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;<link linkend="_structqsc__rcs__state_1a79c090aba458c743cdbf8585f7a058c9">rounds</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
280 <emphasis role="preprocessor">#if&#32;defined(QSC_RCS_AUTH_PMAC)</emphasis>
281 &#32;&#32;&#32;&#32;<link linkend="_structqsc__pmac__state">qsc_pmac_state</link>&#32;<link linkend="_structqsc__rcs__state_1a16bc67e3e7cd6e690a86326d9dc4191d">kstate</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
282 <emphasis role="preprocessor">#else</emphasis>
283 &#32;&#32;&#32;&#32;<link linkend="_structqsc__keccak__state">qsc_keccak_state</link>&#32;<link linkend="_structqsc__rcs__state_1a16bc67e3e7cd6e690a86326d9dc4191d">kstate</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
284 <emphasis role="preprocessor">#endif</emphasis>
285 &#32;&#32;&#32;&#32;uint8_t&#32;<link linkend="_structqsc__rcs__state_1a7e3e2a3d55ef5a060a4ea50ff088cc93">nonce</link>[<link linkend="_rcs_8h_1a790b62fe878b8e489d86da685a0f268e">QSC_RCS_NONCE_SIZE</link>];&#32;&#32;
286 &#32;&#32;&#32;&#32;uint64_t&#32;<link linkend="_structqsc__rcs__state_1a1944753ac8107ec537f75b7e0201d866">counter</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
287 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_structqsc__rcs__state_1af69c97ab299480b81e3f622d79777334">encrypt</link>;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
288 }&#32;<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>;
289 
290 <emphasis role="comment">/*&#32;public&#32;functions&#32;*/</emphasis>
291 
300 QSC_EXPORT_API&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_rcs_8h_1ad3de70d3600ee6a2a3087b9c33393d9d">qsc_rcs_dispose</link>(<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>*&#32;ctx);
301 
309 QSC_EXPORT_API&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_rcs_8h_1a075b831a79637abb8ef4382f5aa11c17">qsc_rcs_initialize</link>(<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>*&#32;ctx,&#32;<emphasis role="keyword">const</emphasis>&#32;<link linkend="_structqsc__rcs__keyparams">qsc_rcs_keyparams</link>*&#32;keyparams,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;encryption);
310 
323 QSC_EXPORT_API&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_rcs_8h_1ab68fe248c655b06d6c13f1eb281abf38">qsc_rcs_set_associated</link>(<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>*&#32;ctx,&#32;<emphasis role="keyword">const</emphasis>&#32;uint8_t*&#32;data,&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;length);
324 
340 QSC_EXPORT_API&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_rcs_8h_1a87a3085452232b535c745f711b4ebd2d">qsc_rcs_transform</link>(<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>*&#32;ctx,&#32;uint8_t*&#32;output,&#32;<emphasis role="keyword">const</emphasis>&#32;uint8_t*&#32;input,&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;length);
341 
362 QSC_EXPORT_API&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_rcs_8h_1ac11273f4f473dd62b1d0866f848d1ce5">qsc_rcs_extended_transform</link>(<link linkend="_structqsc__rcs__state">qsc_rcs_state</link>*&#32;ctx,&#32;uint8_t*&#32;output,&#32;<emphasis role="keyword">const</emphasis>&#32;uint8_t*&#32;input,&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;length,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;finalize);
363 
364 <emphasis role="preprocessor">#endif</emphasis>
</programlisting></section>
