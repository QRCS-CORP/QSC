<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSCTest/mceliece_test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('mceliece__test_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mceliece_test.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>McEliece Test Functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;mceliece_test.h&quot;</code><br />
<code>#include &quot;<a class="el" href="katparser_8h_source.html">katparser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nistrng_8h_source.html">nistrng.h</a>&quot;</code><br />
<code>#include &quot;testutils.h&quot;</code><br />
<code>#include &quot;<a class="el" href="consoleutils_8h_source.html">../QSC/consoleutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="csp_8h_source.html">../QSC/csp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="intutils_8h_source.html">../QSC/intutils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mceliece_8h_source.html">../QSC/mceliece.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memutils_8h_source.html">../QSC/memutils.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67e547ed2f605ff22389e35a28b53311" id="r_a67e547ed2f605ff22389e35a28b53311"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67e547ed2f605ff22389e35a28b53311">qsctest_mceliece_ciphertext_integrity</a> ()</td></tr>
<tr class="memdesc:a67e547ed2f605ff22389e35a28b53311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of a mutated McEliece ciphertext.  <br /></td></tr>
<tr class="separator:a67e547ed2f605ff22389e35a28b53311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b82d6d9f05e9a1c3c6414e02fbc682" id="r_a65b82d6d9f05e9a1c3c6414e02fbc682"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65b82d6d9f05e9a1c3c6414e02fbc682">qsctest_mceliece_kat_test</a> ()</td></tr>
<tr class="memdesc:a65b82d6d9f05e9a1c3c6414e02fbc682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the McEliece Known Answer Test (KAT).  <br /></td></tr>
<tr class="separator:a65b82d6d9f05e9a1c3c6414e02fbc682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d6363444acfb733b70741f1b67188c9" id="r_a2d6363444acfb733b70741f1b67188c9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d6363444acfb733b70741f1b67188c9">qsctest_mceliece_operations_test</a> ()</td></tr>
<tr class="memdesc:a2d6363444acfb733b70741f1b67188c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stress tests the McEliece operations.  <br /></td></tr>
<tr class="separator:a2d6363444acfb733b70741f1b67188c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b0deb415aaa03bf4c2ec2c7b85051a" id="r_a78b0deb415aaa03bf4c2ec2c7b85051a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78b0deb415aaa03bf4c2ec2c7b85051a">qsctest_mceliece_publickey_integrity</a> ()</td></tr>
<tr class="memdesc:a78b0deb415aaa03bf4c2ec2c7b85051a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the integrity of an altered McEliece public key.  <br /></td></tr>
<tr class="separator:a78b0deb415aaa03bf4c2ec2c7b85051a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf1af7484210ebd6d2e6d5e737ccf4c7" id="r_aaf1af7484210ebd6d2e6d5e737ccf4c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf1af7484210ebd6d2e6d5e737ccf4c7">qsctest_mceliece_run</a> ()</td></tr>
<tr class="memdesc:aaf1af7484210ebd6d2e6d5e737ccf4c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the full suite of McEliece tests.  <br /></td></tr>
<tr class="separator:aaf1af7484210ebd6d2e6d5e737ccf4c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>McEliece Test Functions. </p>
<p>This source file contains tests for the McEliece implementation, including both Known Answer Tests (KATs) and stress tests. The tests verify the correctness of key generation, encryption (encapsulation), decapsulation, and the integrity of keys and ciphertext.</p>
<p>The test suite includes:</p>
<ul>
<li>A ciphertext integrity test that ensures a mutated ciphertext fails decapsulation and does not yield the expected shared secret.</li>
<li>A known answer test (KAT) that compares the generated public key, private key, ciphertext, and derived shared secret against expected values from the NIST PQC Round 3 test vectors.</li>
<li>A stress test that exercises the key generation, encapsulation, and decapsulation operations, including an alternate encrypt/decrypt API.</li>
<li>A public key integrity test that verifies that altering the public key results in an invalid shared secret. </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a67e547ed2f605ff22389e35a28b53311" name="a67e547ed2f605ff22389e35a28b53311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e547ed2f605ff22389e35a28b53311">&#9670;&#160;</a></span>qsctest_mceliece_ciphertext_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_mceliece_ciphertext_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of a mutated McEliece ciphertext. </p>
<p>This test generates a McEliece key pair and encapsulates a shared secret, then deliberately mutates the ciphertext by replacing some of its bytes with random data. It then attempts to decapsulate the modified ciphertext and checks that:</p><ul>
<li>Decapsulation fails.</li>
<li>The derived shared secret from the failed decapsulation does not match the expected shared secret.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the mutated ciphertext is correctly detected as invalid; otherwise, false. </dd></dl>

</div>
</div>
<a id="a65b82d6d9f05e9a1c3c6414e02fbc682" name="a65b82d6d9f05e9a1c3c6414e02fbc682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b82d6d9f05e9a1c3c6414e02fbc682">&#9670;&#160;</a></span>qsctest_mceliece_kat_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_mceliece_kat_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the McEliece Known Answer Test (KAT). </p>
<p>This function verifies the correctness of the McEliece implementation by comparing the generated public key, private key, ciphertext, and shared secret with known answer test vectors from the NIST PQC Round 3 test files. It:</p><ul>
<li>Parses the KAT file corresponding to the active parameter set.</li>
<li>Generates a key pair and compares the keys to the expected values.</li>
<li>Encapsulates a shared secret and compares the ciphertext and shared secret to the known answers.</li>
<li>Decapsulates the ciphertext and verifies that the derived shared secret matches the expected value.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all generated values match the known answer test vectors; otherwise, false. </dd></dl>

</div>
</div>
<a id="a2d6363444acfb733b70741f1b67188c9" name="a2d6363444acfb733b70741f1b67188c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d6363444acfb733b70741f1b67188c9">&#9670;&#160;</a></span>qsctest_mceliece_operations_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_mceliece_operations_test </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stress tests the McEliece operations. </p>
<p>This function performs a stress test on the McEliece key encapsulation mechanism by:</p><ul>
<li>Generating a key pair.</li>
<li>Encapsulating a shared secret to produce a ciphertext and shared secret.</li>
<li>Decapsulating the ciphertext to derive the shared secret.</li>
<li>Verifying that the shared secrets obtained from encapsulation and decapsulation are identical.</li>
<li>Exercising an alternate encrypt/decrypt API to confirm consistent behavior.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all operations produce matching shared secrets; otherwise, false. </dd></dl>

</div>
</div>
<a id="a78b0deb415aaa03bf4c2ec2c7b85051a" name="a78b0deb415aaa03bf4c2ec2c7b85051a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b0deb415aaa03bf4c2ec2c7b85051a">&#9670;&#160;</a></span>qsctest_mceliece_publickey_integrity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_mceliece_publickey_integrity </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the integrity of an altered McEliece public key. </p>
<p>This test generates a McEliece key pair and then alters the public key by replacing a portion of its bytes with random values. It then performs encapsulation using the tampered public key and attempts decapsulation with the valid secret key. The test passes if the derived shared secret is invalid, confirming that the altered public key does not yield the expected result.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the tampered public key causes the shared secret to be invalid; otherwise, false. </dd></dl>

</div>
</div>
<a id="aaf1af7484210ebd6d2e6d5e737ccf4c7" name="aaf1af7484210ebd6d2e6d5e737ccf4c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf1af7484210ebd6d2e6d5e737ccf4c7">&#9670;&#160;</a></span>qsctest_mceliece_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_mceliece_run </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the full suite of McEliece tests. </p>
<p>This function sequentially executes all McEliece tests, including:</p><ul>
<li>The Known Answer Test (KAT) for verifying key generation, encryption (encapsulation), and decryption (decapsulation).</li>
<li>The operations stress test for repeated key generation and shared secret derivation.</li>
<li>The public key integrity test to ensure that altering the public key invalidates the derived shared secret.</li>
<li>The ciphertext integrity test to confirm that tampering with the ciphertext is detected.</li>
</ul>
<p>Results from each test are printed to the console. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_12ba33f14d153ce862ef28362b3660f0.html">QSCTest</a></li><li class="navelem"><a class="el" href="mceliece__test_8c.html">mceliece_test.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
