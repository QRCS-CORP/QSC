<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSCTest/secrand_test.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('secrand__test_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">secrand_test.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Entropy Provider Tests.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;common.h&quot;</code><br />
</div>
<p><a href="secrand__test_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8352ee69b1300abbedc57a9a3c35d494" id="r_a8352ee69b1300abbedc57a9a3c35d494"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8352ee69b1300abbedc57a9a3c35d494">QSCTEST_SECRAND_SAMPLE_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="memdesc:a8352ee69b1300abbedc57a9a3c35d494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the random sample used in the tests.  <br /></td></tr>
<tr class="separator:a8352ee69b1300abbedc57a9a3c35d494"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6b5f5cfd8f012e3390009091b0916d15" id="r_a6b5f5cfd8f012e3390009091b0916d15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b5f5cfd8f012e3390009091b0916d15">qsctest_secrand_evaluate</a> (const char *name, const uint8_t *sample, size_t length)</td></tr>
<tr class="memdesc:a6b5f5cfd8f012e3390009091b0916d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of a random provider.  <br /></td></tr>
<tr class="separator:a6b5f5cfd8f012e3390009091b0916d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e35f389b9ab5a413bdf6446af7420c9" id="r_a1e35f389b9ab5a413bdf6446af7420c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e35f389b9ab5a413bdf6446af7420c9">qsctest_secrand_acp_evaluate</a> (void)</td></tr>
<tr class="memdesc:a1e35f389b9ab5a413bdf6446af7420c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the ACP random provider.  <br /></td></tr>
<tr class="separator:a1e35f389b9ab5a413bdf6446af7420c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a32d0f8c7b6f138f1c57cb063061aac" id="r_a8a32d0f8c7b6f138f1c57cb063061aac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a32d0f8c7b6f138f1c57cb063061aac">qsctest_secrand_csg_evaluate</a> (void)</td></tr>
<tr class="memdesc:a8a32d0f8c7b6f138f1c57cb063061aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the CSG deterministic random bit generator (DRBG).  <br /></td></tr>
<tr class="separator:a8a32d0f8c7b6f138f1c57cb063061aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6663237e0b0768e4e10e6f2cf08955dc" id="r_a6663237e0b0768e4e10e6f2cf08955dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6663237e0b0768e4e10e6f2cf08955dc">qsctest_secrand_csp_evaluate</a> (void)</td></tr>
<tr class="memdesc:a6663237e0b0768e4e10e6f2cf08955dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the CSP random provider.  <br /></td></tr>
<tr class="separator:a6663237e0b0768e4e10e6f2cf08955dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ed8e595c7ea1be66b9612658501441" id="r_ab3ed8e595c7ea1be66b9612658501441"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3ed8e595c7ea1be66b9612658501441">qsctest_secrand_hcg_evaluate</a> (void)</td></tr>
<tr class="memdesc:ab3ed8e595c7ea1be66b9612658501441"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the HCG deterministic random bit generator (DRBG).  <br /></td></tr>
<tr class="separator:ab3ed8e595c7ea1be66b9612658501441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecffcdbbda90e740245a3c3eb380b4a3" id="r_aecffcdbbda90e740245a3c3eb380b4a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecffcdbbda90e740245a3c3eb380b4a3">qsctest_secrand_rdp_evaluate</a> (void)</td></tr>
<tr class="memdesc:aecffcdbbda90e740245a3c3eb380b4a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the RDP random provider.  <br /></td></tr>
<tr class="separator:aecffcdbbda90e740245a3c3eb380b4a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a213d6b644d06faabd106ba52212e7f16" id="r_a213d6b644d06faabd106ba52212e7f16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a213d6b644d06faabd106ba52212e7f16">qsctest_secrand_scb_evaluate</a> (void)</td></tr>
<tr class="memdesc:a213d6b644d06faabd106ba52212e7f16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the output of the SCB key derivation function.  <br /></td></tr>
<tr class="separator:a213d6b644d06faabd106ba52212e7f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72beddc487978a4b6cee66b6f062c393" id="r_a72beddc487978a4b6cee66b6f062c393"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72beddc487978a4b6cee66b6f062c393">qsctest_secrand_stress</a> (void)</td></tr>
<tr class="memdesc:a72beddc487978a4b6cee66b6f062c393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a stress test on the secure random number generators.  <br /></td></tr>
<tr class="separator:a72beddc487978a4b6cee66b6f062c393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217dfe1db6b16a8c041f58d58b9f5670" id="r_a217dfe1db6b16a8c041f58d58b9f5670"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a217dfe1db6b16a8c041f58d58b9f5670">qsctest_secrand_run</a> (void)</td></tr>
<tr class="memdesc:a217dfe1db6b16a8c041f58d58b9f5670"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs all secure random (entropy provider) tests.  <br /></td></tr>
<tr class="separator:a217dfe1db6b16a8c041f58d58b9f5670"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Entropy Provider Tests. </p>
<p>This header defines functions for testing the secure random (entropy) providers and key derivation functions. It includes both stress tests and statistical evaluations (wellness tests) for various random generators, such as ACP, CSP, CSG, HCG, RDP, and SCB. The tests compute statistical measures including mean value, chi-square, ordered runs, and successive zeroes on a random sample to assess the quality of the random data. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8352ee69b1300abbedc57a9a3c35d494" name="a8352ee69b1300abbedc57a9a3c35d494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8352ee69b1300abbedc57a9a3c35d494">&#9670;&#160;</a></span>QSCTEST_SECRAND_SAMPLE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QSCTEST_SECRAND_SAMPLE_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the random sample used in the tests. </p>
<p>The random sample size for evaluating the entropy providers is defined as 65536 bytes. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1e35f389b9ab5a413bdf6446af7420c9" name="a1e35f389b9ab5a413bdf6446af7420c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e35f389b9ab5a413bdf6446af7420c9">&#9670;&#160;</a></span>qsctest_secrand_acp_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_acp_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the ACP random provider. </p>
<p>This function generates a random sample using the ACP entropy provider and then evaluates its statistical properties by calling <code><a class="el" href="#a6b5f5cfd8f012e3390009091b0916d15" title="Evaluates the output of a random provider.">qsctest_secrand_evaluate()</a></code>. </p>

</div>
</div>
<a id="a8a32d0f8c7b6f138f1c57cb063061aac" name="a8a32d0f8c7b6f138f1c57cb063061aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a32d0f8c7b6f138f1c57cb063061aac">&#9670;&#160;</a></span>qsctest_secrand_csg_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_csg_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the CSG deterministic random bit generator (DRBG). </p>
<p>This function generates a random sample using the CSG DRBG and performs statistical evaluations on the sample. </p>

</div>
</div>
<a id="a6663237e0b0768e4e10e6f2cf08955dc" name="a6663237e0b0768e4e10e6f2cf08955dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6663237e0b0768e4e10e6f2cf08955dc">&#9670;&#160;</a></span>qsctest_secrand_csp_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_csp_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the CSP random provider. </p>
<p>This function collects a random sample using the CSP provider and then assesses its statistical properties. </p>

</div>
</div>
<a id="a6b5f5cfd8f012e3390009091b0916d15" name="a6b5f5cfd8f012e3390009091b0916d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b5f5cfd8f012e3390009091b0916d15">&#9670;&#160;</a></span>qsctest_secrand_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_evaluate </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of a random provider. </p>
<p>This function computes statistical measures on a provided random sample, including:</p><ul>
<li>Mean value (optimal is 127.5 for uniformly distributed 8-bit data)</li>
<li>Chi-square statistic, expressed as a percentage likelihood</li>
<li>Ordered runs test, to detect unusually long sequences of identical values</li>
<li>Successive zeroes test, to detect runs of zeros.</li>
</ul>
<p>The function prints the computed values and indicates whether the sample passes, warns, or fails the tests.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the random provider. </td></tr>
    <tr><td class="paramname">sample</td><td>Pointer to the random sample data. </td></tr>
    <tr><td class="paramname">length</td><td>Length of the random sample in bytes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab3ed8e595c7ea1be66b9612658501441" name="ab3ed8e595c7ea1be66b9612658501441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3ed8e595c7ea1be66b9612658501441">&#9670;&#160;</a></span>qsctest_secrand_hcg_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_hcg_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the HCG deterministic random bit generator (DRBG). </p>
<p>This function generates a random sample using the HCG DRBG and evaluates it using statistical tests. </p>

</div>
</div>
<a id="aecffcdbbda90e740245a3c3eb380b4a3" name="aecffcdbbda90e740245a3c3eb380b4a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecffcdbbda90e740245a3c3eb380b4a3">&#9670;&#160;</a></span>qsctest_secrand_rdp_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_rdp_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the RDP random provider. </p>
<p>This function generates a random sample using the RDP provider (compatible with RDRAND) and performs statistical evaluations on the sample. </p>

</div>
</div>
<a id="a217dfe1db6b16a8c041f58d58b9f5670" name="a217dfe1db6b16a8c041f58d58b9f5670"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a217dfe1db6b16a8c041f58d58b9f5670">&#9670;&#160;</a></span>qsctest_secrand_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_run </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs all secure random (entropy provider) tests. </p>
<p>This function executes a comprehensive test suite for secure random number generators and key derivation functions. It first runs a stress test on the PRNG, then evaluates the output of various random providers, including:</p><ul>
<li>ACP and CSP (and optionally RDP if available)</li>
<li>Deterministic random bit generators (CSG and HCG)</li>
<li>The SCB key derivation function.</li>
</ul>
<p>Test results and evaluation statistics are printed to the console. </p>

</div>
</div>
<a id="a213d6b644d06faabd106ba52212e7f16" name="a213d6b644d06faabd106ba52212e7f16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a213d6b644d06faabd106ba52212e7f16">&#9670;&#160;</a></span>qsctest_secrand_scb_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qsctest_secrand_scb_evaluate </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the output of the SCB key derivation function. </p>
<p>This function uses the SCB (SHAKE Cost-Based KDF) implementation to generate a random sample, and then evaluates its statistical properties. </p>

</div>
</div>
<a id="a72beddc487978a4b6cee66b6f062c393" name="a72beddc487978a4b6cee66b6f062c393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72beddc487978a4b6cee66b6f062c393">&#9670;&#160;</a></span>qsctest_secrand_stress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool qsctest_secrand_stress </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a stress test on the secure random number generators. </p>
<p>This function tests various secure random generation functions by invoking calls that generate random values of various types (e.g., char, unsigned char, double, int16, uint16, int32, uint32, int64, uint64) and verifies that the outputs fall within expected ranges.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all random generation tests pass; otherwise, false. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_12ba33f14d153ce862ef28362b3660f0.html">QSCTest</a></li><li class="navelem"><a class="el" href="secrand__test_8h.html">secrand_test.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
