<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QSC Post Quantum Cryptographic Library: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSC/QSC/csx.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qsc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QSC Post Quantum Cryptographic Library<span id="projectnumber">&#160;1.0.0.6b (A6)</span>
   </div>
   <div id="projectbrief">A post quantum secure library written in Ansi C</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('csx_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">csx.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>ChaCha-based authenticated Stream cipher eXtension.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sha3_8h_source.html">sha3.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qmac_8h_source.html">qmac.h</a>&quot;</code><br />
</div>
<p><a href="csx_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqsc__csx__keyparams.html">qsc_csx_keyparams</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The key parameters structure containing key, nonce, and info arrays and lengths. Use this structure to load an input cipher-key and optional info tweak, using the qsc_csx_initialize function. Keys must be random and secret, and align to the corresponding key size of the cipher implemented. The info parameter is optional, and can be a salt or cryptographic key. The nonce is always QSC_CSX_BLOCK_SIZE in length.  <a href="structqsc__csx__keyparams.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The internal state structure containing the round-key array.  <a href="structqsc__csx__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a41abb38a317351ca70b7c29ae8edc25c" id="r_a41abb38a317351ca70b7c29ae8edc25c"><td class="memItemLeft" align="right" valign="top"><a id="a41abb38a317351ca70b7c29ae8edc25c" name="a41abb38a317351ca70b7c29ae8edc25c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_AUTHENTICATED</b></td></tr>
<tr class="memdesc:a41abb38a317351ca70b7c29ae8edc25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables KMAC authentication mode. <br /></td></tr>
<tr class="separator:a41abb38a317351ca70b7c29ae8edc25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80cbe37c9220b12278f66eb67cffc0ff" id="r_a80cbe37c9220b12278f66eb67cffc0ff"><td class="memItemLeft" align="right" valign="top"><a id="a80cbe37c9220b12278f66eb67cffc0ff" name="a80cbe37c9220b12278f66eb67cffc0ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_AUTH_QMAC</b></td></tr>
<tr class="memdesc:a80cbe37c9220b12278f66eb67cffc0ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the reduced rounds QMAC implementation. <br /></td></tr>
<tr class="separator:a80cbe37c9220b12278f66eb67cffc0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801f494563418072c7cac15f53deea0d" id="r_a801f494563418072c7cac15f53deea0d"><td class="memItemLeft" align="right" valign="top"><a id="a801f494563418072c7cac15f53deea0d" name="a801f494563418072c7cac15f53deea0d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_BLOCK_SIZE</b>&#160;&#160;&#160;128ULL</td></tr>
<tr class="memdesc:a801f494563418072c7cac15f53deea0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The internal block size in bytes, required by the encryption and decryption functions. <br /></td></tr>
<tr class="separator:a801f494563418072c7cac15f53deea0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8966fccfdb20447b1c03ba7672e8f9e6" id="r_a8966fccfdb20447b1c03ba7672e8f9e6"><td class="memItemLeft" align="right" valign="top"><a id="a8966fccfdb20447b1c03ba7672e8f9e6" name="a8966fccfdb20447b1c03ba7672e8f9e6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_INFO_SIZE</b>&#160;&#160;&#160;48ULL</td></tr>
<tr class="memdesc:a8966fccfdb20447b1c03ba7672e8f9e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum byte length of the info string. <br /></td></tr>
<tr class="separator:a8966fccfdb20447b1c03ba7672e8f9e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a422344e80cc04e590c8a278a5a6263e5" id="r_a422344e80cc04e590c8a278a5a6263e5"><td class="memItemLeft" align="right" valign="top"><a id="a422344e80cc04e590c8a278a5a6263e5" name="a422344e80cc04e590c8a278a5a6263e5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_KEY_SIZE</b>&#160;&#160;&#160;64ULL</td></tr>
<tr class="memdesc:a422344e80cc04e590c8a278a5a6263e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size in bytes of the CSX-512 input cipher-key. <br /></td></tr>
<tr class="separator:a422344e80cc04e590c8a278a5a6263e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a17ebd1d3e6440e22b01c03e23d7fc3" id="r_a1a17ebd1d3e6440e22b01c03e23d7fc3"><td class="memItemLeft" align="right" valign="top"><a id="a1a17ebd1d3e6440e22b01c03e23d7fc3" name="a1a17ebd1d3e6440e22b01c03e23d7fc3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_MAC_SIZE</b>&#160;&#160;&#160;32ULL</td></tr>
<tr class="memdesc:a1a17ebd1d3e6440e22b01c03e23d7fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The CSX MAC code array length in bytes. <br /></td></tr>
<tr class="separator:a1a17ebd1d3e6440e22b01c03e23d7fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad87d0d2b87a9c27c9a6de576636de7" id="r_aaad87d0d2b87a9c27c9a6de576636de7"><td class="memItemLeft" align="right" valign="top"><a id="aaad87d0d2b87a9c27c9a6de576636de7" name="aaad87d0d2b87a9c27c9a6de576636de7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_NONCE_SIZE</b>&#160;&#160;&#160;16ULL</td></tr>
<tr class="memdesc:aaad87d0d2b87a9c27c9a6de576636de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The byte size of the nonce array. <br /></td></tr>
<tr class="separator:aaad87d0d2b87a9c27c9a6de576636de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85063a4106ffb3e7972b618da25aee65" id="r_a85063a4106ffb3e7972b618da25aee65"><td class="memItemLeft" align="right" valign="top"><a id="a85063a4106ffb3e7972b618da25aee65" name="a85063a4106ffb3e7972b618da25aee65"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>QSC_CSX_STATE_SIZE</b>&#160;&#160;&#160;16ULL</td></tr>
<tr class="memdesc:a85063a4106ffb3e7972b618da25aee65"><td class="mdescLeft">&#160;</td><td class="mdescRight">The uint64 size of the internal state array. <br /></td></tr>
<tr class="separator:a85063a4106ffb3e7972b618da25aee65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8b31ea0f6668281d4655cf44e101f25c" id="r_a8b31ea0f6668281d4655cf44e101f25c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b31ea0f6668281d4655cf44e101f25c">qsc_csx_dispose</a> (<a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx)</td></tr>
<tr class="memdesc:a8b31ea0f6668281d4655cf44e101f25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose of the CSX cipher state.  <br /></td></tr>
<tr class="separator:a8b31ea0f6668281d4655cf44e101f25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4402e25572adb9ac6860c4b17e75ad" id="r_a9f4402e25572adb9ac6860c4b17e75ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f4402e25572adb9ac6860c4b17e75ad">qsc_csx_initialize</a> (<a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx, const <a class="el" href="structqsc__csx__keyparams.html">qsc_csx_keyparams</a> *keyparams, bool encryption)</td></tr>
<tr class="memdesc:a9f4402e25572adb9ac6860c4b17e75ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the state with the input cipher-key and optional info tweak.  <br /></td></tr>
<tr class="separator:a9f4402e25572adb9ac6860c4b17e75ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb9d323b45bef12eabe68852a136be6" id="r_a5eb9d323b45bef12eabe68852a136be6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5eb9d323b45bef12eabe68852a136be6">qsc_csx_set_associated</a> (<a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx, const uint8_t *data, size_t length)</td></tr>
<tr class="memdesc:a5eb9d323b45bef12eabe68852a136be6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the associated data string used in authenticating the message. The associated data may be packet header information, domain specific data, or a secret shared by a group. The associated data must be set after initialization, and before each transformation call. The data is erased after each call to the transform.  <br /></td></tr>
<tr class="separator:a5eb9d323b45bef12eabe68852a136be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e604bf45f89b721bd003cfdc5bbcd4" id="r_a08e604bf45f89b721bd003cfdc5bbcd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08e604bf45f89b721bd003cfdc5bbcd4">qsc_csx_store_nonce</a> (const <a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx, uint8_t nonce[<a class="el" href="#aaad87d0d2b87a9c27c9a6de576636de7">QSC_CSX_NONCE_SIZE</a>])</td></tr>
<tr class="memdesc:a08e604bf45f89b721bd003cfdc5bbcd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the current nonce from the state.  <br /></td></tr>
<tr class="separator:a08e604bf45f89b721bd003cfdc5bbcd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071d11fa66ebccee8e8fc7ae9bc58696" id="r_a071d11fa66ebccee8e8fc7ae9bc58696"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a071d11fa66ebccee8e8fc7ae9bc58696">qsc_csx_transform</a> (<a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx, uint8_t *output, const uint8_t *input, size_t length)</td></tr>
<tr class="memdesc:a071d11fa66ebccee8e8fc7ae9bc58696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform an array of bytes. In encryption mode, the input plain-text is encrypted and then an authentication MAC code is appended to the cipher-text. In decryption mode, the input cipher-text is authenticated internally and compared to the MAC code appended to the cipher-text, if the codes to not match, the cipher-text is not decrypted and the call fails.  <br /></td></tr>
<tr class="separator:a071d11fa66ebccee8e8fc7ae9bc58696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab70bbd32fd86948d6206b1c48b75deea" id="r_ab70bbd32fd86948d6206b1c48b75deea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab70bbd32fd86948d6206b1c48b75deea">qsc_csx_extended_transform</a> (<a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *ctx, uint8_t *output, const uint8_t *input, size_t length, bool finalize)</td></tr>
<tr class="memdesc:ab70bbd32fd86948d6206b1c48b75deea"><td class="mdescLeft">&#160;</td><td class="mdescRight">A multi-call transform for a large array of bytes, such as required by file encryption. This call can be used to transform and authenticate a very large array of bytes (+1GB). On the last call in the sequence, set the finalize parameter to true to complete authentication, and write the MAC code to the end of the output array in encryption mode, or compare to the embedded MAC code and authenticate in decryption mode. In encryption mode, the input plain-text is encrypted, then authenticated, and the MAC code is appended to the cipher-text. In decryption mode, the input cipher-text is authenticated internally and compared to the MAC code appended to the cipher-text, if the codes do not match, the cipher-text is not decrypted and the call fails.  <br /></td></tr>
<tr class="separator:ab70bbd32fd86948d6206b1c48b75deea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ChaCha-based authenticated Stream cipher eXtension. </p>
<p>This header defines the public API for the CSX-512 cipher, a wide-block ChaCha-based authenticated stream cipher extension. CSX-512 is a vectorized, 64-bit, 40-round stream cipher that uses a 512-bit input key, a 16-byte nonce, and an optional tweak (info) parameter. The cipher employs the Keccak cSHAKE-512 extended output function (XOF) to expand the input cipher-key into both the cipher key and the MAC key. It integrates a post-quantum secure MAC function (QMAC or KMAC) for message authentication, operating in an encrypt-then-MAC configuration to provide authenticated encryption with associated data (AEAD). In decryption mode, the MAC code embedded in the ciphertext is verified prior to decryption, ensuring data integrity and authenticity.</p>
<dl class="section user"><dt>Example Usage:</dt><dd><div class="fragment"><div class="line"><span class="comment">// External message, key, nonce, and custom-info arrays</span></div>
<div class="line"><span class="preprocessor">#define CSTLEN 20</span></div>
<div class="line"><span class="preprocessor">#define MSGLEN 200</span></div>
<div class="line">uint8_t cust[CSTLEN] = { ... };</div>
<div class="line">uint8_t key[<a class="code hl_define" href="#a422344e80cc04e590c8a278a5a6263e5">QSC_CSX_KEY_SIZE</a>] = { ... };</div>
<div class="line">uint8_t msg[MSGLEN] = { ... };</div>
<div class="line">uint8_t nonce[<a class="code hl_define" href="#aaad87d0d2b87a9c27c9a6de576636de7">QSC_CSX_NONCE_SIZE</a>] = { ... };</div>
<div class="line">uint8_t cpt[MSGLEN + <a class="code hl_define" href="#a1a17ebd1d3e6440e22b01c03e23d7fc3">QSC_CSX_MAC_SIZE</a>] = { 0 };</div>
<div class="line"><a class="code hl_struct" href="structqsc__csx__state.html">qsc_csx_state</a> state;</div>
<div class="line"><a class="code hl_struct" href="structqsc__csx__keyparams.html">qsc_csx_keyparams</a> kp = { key, <a class="code hl_define" href="#a422344e80cc04e590c8a278a5a6263e5">QSC_CSX_KEY_SIZE</a>, nonce, cust, CSTLEN };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize the state for encryption</span></div>
<div class="line">qsc_csx_initialize(&amp;state, &amp;kp, <span class="keyword">true</span>);</div>
<div class="line"><span class="comment">// Encrypt the message</span></div>
<div class="line">qsc_csx_transform(&amp;state, cpt, msg, MSGLEN);</div>
<div class="ttc" id="acsx_8h_html_a1a17ebd1d3e6440e22b01c03e23d7fc3"><div class="ttname"><a href="#a1a17ebd1d3e6440e22b01c03e23d7fc3">QSC_CSX_MAC_SIZE</a></div><div class="ttdeci">#define QSC_CSX_MAC_SIZE</div><div class="ttdoc">The CSX MAC code array length in bytes.</div><div class="ttdef"><b>Definition</b> csx.h:152</div></div>
<div class="ttc" id="acsx_8h_html_a422344e80cc04e590c8a278a5a6263e5"><div class="ttname"><a href="#a422344e80cc04e590c8a278a5a6263e5">QSC_CSX_KEY_SIZE</a></div><div class="ttdeci">#define QSC_CSX_KEY_SIZE</div><div class="ttdoc">The size in bytes of the CSX-512 input cipher-key.</div><div class="ttdef"><b>Definition</b> csx.h:145</div></div>
<div class="ttc" id="acsx_8h_html_aaad87d0d2b87a9c27c9a6de576636de7"><div class="ttname"><a href="#aaad87d0d2b87a9c27c9a6de576636de7">QSC_CSX_NONCE_SIZE</a></div><div class="ttdeci">#define QSC_CSX_NONCE_SIZE</div><div class="ttdoc">The byte size of the nonce array.</div><div class="ttdef"><b>Definition</b> csx.h:165</div></div>
<div class="ttc" id="astructqsc__csx__keyparams_html"><div class="ttname"><a href="structqsc__csx__keyparams.html">qsc_csx_keyparams</a></div><div class="ttdoc">The key parameters structure containing key, nonce, and info arrays and lengths. Use this structure t...</div><div class="ttdef"><b>Definition</b> csx.h:182</div></div>
<div class="ttc" id="astructqsc__csx__state_html"><div class="ttname"><a href="structqsc__csx__state.html">qsc_csx_state</a></div><div class="ttdoc">The internal state structure containing the round-key array.</div><div class="ttdef"><b>Definition</b> csx.h:195</div></div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="csx_links"></a>
Reference Links:</h1>
<ul>
<li><a href="https://cr.yp.to/chacha/chacha-20080120.pdf">Official ChaCha20 Specification</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">NIST FIPS 202 (SHA-3) Standard</a></li>
<li><a href="https://www.math.ubc.ca/~cass/grad/2009-2010/Notes/FiniteFields.pdf">Galois Field Theory Reference</a> </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8b31ea0f6668281d4655cf44e101f25c" name="a8b31ea0f6668281d4655cf44e101f25c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b31ea0f6668281d4655cf44e101f25c">&#9670;&#160;</a></span>qsc_csx_dispose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void qsc_csx_dispose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispose of the CSX cipher state. </p>
<dl class="section warning"><dt>Warning</dt><dd>The dispose function must be called when disposing of the cipher. This function destroys the internal state of the cipher.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab70bbd32fd86948d6206b1c48b75deea" name="ab70bbd32fd86948d6206b1c48b75deea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab70bbd32fd86948d6206b1c48b75deea">&#9670;&#160;</a></span>qsc_csx_extended_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> bool qsc_csx_extended_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>finalize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A multi-call transform for a large array of bytes, such as required by file encryption. This call can be used to transform and authenticate a very large array of bytes (+1GB). On the last call in the sequence, set the finalize parameter to true to complete authentication, and write the MAC code to the end of the output array in encryption mode, or compare to the embedded MAC code and authenticate in decryption mode. In encryption mode, the input plain-text is encrypted, then authenticated, and the MAC code is appended to the cipher-text. In decryption mode, the input cipher-text is authenticated internally and compared to the MAC code appended to the cipher-text, if the codes do not match, the cipher-text is not decrypted and the call fails. </p>
<dl class="section warning"><dt>Warning</dt><dd>The cipher must be initialized before this function can be called</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
    <tr><td class="paramname">output</td><td>[uint8_t*] A pointer to the output array </td></tr>
    <tr><td class="paramname">input</td><td>[const] A pointer to the input array </td></tr>
    <tr><td class="paramname">length</td><td>[size_t] The number of bytes to transform </td></tr>
    <tr><td class="paramname">finalize</td><td>[bool] Complete authentication on a stream if set to true</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: [bool] Returns true if the cipher has been transformed the data successfully, false on failure </dd></dl>

</div>
</div>
<a id="a9f4402e25572adb9ac6860c4b17e75ad" name="a9f4402e25572adb9ac6860c4b17e75ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4402e25572adb9ac6860c4b17e75ad">&#9670;&#160;</a></span>qsc_csx_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void qsc_csx_initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structqsc__csx__keyparams.html">qsc_csx_keyparams</a> *</td>          <td class="paramname"><span class="paramname"><em>keyparams</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>encryption</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the state with the input cipher-key and optional info tweak. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
    <tr><td class="paramname">keyparams</td><td>[const][struct] The secret input cipher-key and nonce structure </td></tr>
    <tr><td class="paramname">encryption</td><td>[bool] Initialize the cipher for encryption, or false for decryption mode </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5eb9d323b45bef12eabe68852a136be6" name="a5eb9d323b45bef12eabe68852a136be6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb9d323b45bef12eabe68852a136be6">&#9670;&#160;</a></span>qsc_csx_set_associated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void qsc_csx_set_associated </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the associated data string used in authenticating the message. The associated data may be packet header information, domain specific data, or a secret shared by a group. The associated data must be set after initialization, and before each transformation call. The data is erased after each call to the transform. </p>
<dl class="section warning"><dt>Warning</dt><dd>The cipher must be initialized before this function can be called</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
    <tr><td class="paramname">data</td><td>[const] The associated data array </td></tr>
    <tr><td class="paramname">length</td><td>[size_t] The associated data array length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a08e604bf45f89b721bd003cfdc5bbcd4" name="a08e604bf45f89b721bd003cfdc5bbcd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e604bf45f89b721bd003cfdc5bbcd4">&#9670;&#160;</a></span>qsc_csx_store_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> void qsc_csx_store_nonce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>[QSC_CSX_NONCE_SIZE]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the current nonce from the state. </p>
<dl class="section warning"><dt>Warning</dt><dd>If reusing a nonce/key, the nonce must be retrieved after the last finalized transform call.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
    <tr><td class="paramname">nonce</td><td>[uint8_t*] The output nonce array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a071d11fa66ebccee8e8fc7ae9bc58696" name="a071d11fa66ebccee8e8fc7ae9bc58696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071d11fa66ebccee8e8fc7ae9bc58696">&#9670;&#160;</a></span>qsc_csx_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a2ef395ab64e46f80b9e391669b062bef">QSC_EXPORT_API</a> bool qsc_csx_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqsc__csx__state.html">qsc_csx_state</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transform an array of bytes. In encryption mode, the input plain-text is encrypted and then an authentication MAC code is appended to the cipher-text. In decryption mode, the input cipher-text is authenticated internally and compared to the MAC code appended to the cipher-text, if the codes to not match, the cipher-text is not decrypted and the call fails. </p>
<dl class="section warning"><dt>Warning</dt><dd>The cipher must be initialized before this function can be called</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[struct] The cipher state structure </td></tr>
    <tr><td class="paramname">output</td><td>[uint8_t*] A pointer to the output array </td></tr>
    <tr><td class="paramname">input</td><td>[const] A pointer to the input array </td></tr>
    <tr><td class="paramname">length</td><td>[size_t] The number of bytes to transform</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: [bool] Returns true if the cipher has been transformed the data successfully, false on failure </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e9ce06a8fabd9a65cddff1db044522c4.html">QSC</a></li><li class="navelem"><a class="el" href="csx_8h.html">csx.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
